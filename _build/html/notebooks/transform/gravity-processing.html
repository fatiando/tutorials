
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Processing and gridding gravity data with Fatiando a Terra &#8212; Fatiando Tutorials</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Gridding with Scipy" href="../verde/scipygridder.html" />
    <link rel="prev" title="Using weights in blocked reduction" href="../verde/blockreduce_weights.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/fatiando-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fatiando Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to Fatiando a Terra tutorials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials on Transform
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../verde/blockreduce_weights.html">
   Using weights in blocked reduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials using verde
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Processing and gridding gravity data with Fatiando a Terra
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../verde/scipygridder.html">
   Gridding with Scipy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../verde/blockkfold.html">
     K-Fold cross-validation with blocks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../verde/blockreduce.html">
     Blocked reduction operations
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/transform/gravity-processing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/transform/gravity-processing.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#study-area">
   Study area
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages">
   Import packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fetch-the-data">
   Fetch the data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-data-using-ensaio">
     Downloading data using Ensaio
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-data-using-pooch">
     Downloading data using Pooch
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-data">
   Load the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#crop-the-data-to-the-bushveld">
   Crop the data to the Bushveld
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-data">
   Plot the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-the-grids-and-data">
   Project the grids and data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference-heights-to-the-ellipsoid">
   Reference heights to the ellipsoid
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gravity-disturbance">
   Gravity disturbance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#topographic-correction">
   Topographic correction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regional-residual-separation">
   Regional-residual separation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grid-the-residuals">
   Grid the residuals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where-to-go-next">
   Where to go next
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#license">
   License
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Processing and gridding gravity data with Fatiando a Terra</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#study-area">
   Study area
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-packages">
   Import packages
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fetch-the-data">
   Fetch the data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-data-using-ensaio">
     Downloading data using Ensaio
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#downloading-data-using-pooch">
     Downloading data using Pooch
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-the-data">
   Load the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#crop-the-data-to-the-bushveld">
   Crop the data to the Bushveld
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-data">
   Plot the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#project-the-grids-and-data">
   Project the grids and data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reference-heights-to-the-ellipsoid">
   Reference heights to the ellipsoid
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gravity-disturbance">
   Gravity disturbance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#topographic-correction">
   Topographic correction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regional-residual-separation">
   Regional-residual separation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grid-the-residuals">
   Grid the residuals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where-to-go-next">
   Where to go next
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#license">
   License
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="processing-and-gridding-gravity-data-with-fatiando-a-terra">
<h1>Processing and gridding gravity data with Fatiando a Terra<a class="headerlink" href="#processing-and-gridding-gravity-data-with-fatiando-a-terra" title="Permalink to this headline">¶</a></h1>
<p><strong>Authors:</strong>
<a class="reference external" href="https://github.com/santisoler">Santiago Soler</a>,
<a class="reference external" href="https://github.com/andieie">Andrea Balza Morales</a>,
<a class="reference external" href="https://github.com/aguspesce">Agustina Pesce</a>,
<a class="reference external" href="https://github.com/leouieda">Leonardo Uieda</a></p>
<p>In this tutorial, we will walk through the steps of transforming observed absolute gravity measurements into a grid of residual gravity disturbances at a constant height. On our way there, we will showcase some of the core utilities of many of our open-source libraries:</p>
<ol class="simple">
<li><p>Fetch and cache the data using <a class="reference external" href="https://github.com/fatiando/ensaio">Ensaio</a> or <a class="reference external" href="https://github.com/fatiando/pooch">Pooch</a></p></li>
<li><p>Calculate the gravity disturbance using <a class="reference external" href="https://github.com/fatiando/boule">Boule</a></p></li>
<li><p>Interpolate data and apply map projections to grids using <a class="reference external" href="https://github.com/fatiando/verde">Verde</a></p></li>
<li><p>Perform topographic correction and equivalent-source interpolation using <a class="reference external" href="https://github.com/fatiando/harmonica">Harmonica</a></p></li>
</ol>
<div class="section" id="study-area">
<h2>Study area<a class="headerlink" href="#study-area" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Bushveld Igneous Complex</strong> is located in South Africa and is the largest known layered igneous intrusion. It has been tilted and eroded forming the outcrops around what appears to be the edge of a great geological basin: the Transvaal Basin. It is approximately 2 billion years old and is divided into four different limbs: the northern, southern, eastern, and western limbs. The Bushveld Complex comprises the Rustenburg Layered suite, the Lebowa Granites and the Rooiberg Felsics, that are overlain by the Karoo sediments. See <a class="reference external" href="https://doi.org/10.2113/107.1-2.207">Webb et al. (2004)</a> for an overview and previous interpretations of the Bushveld in depth.</p>
<figure>
<img src="images/bushveld_igneous_complex_geology.jpg" alt="Geologic map of the Bushveld Complex">
<figcaption><em>
    Geology and mineral exploration sites of the Bushveld Igneous Complex 
    (<a href="https://en.wikipedia.org/wiki/File:Bushveld_Igneous_Complex.png">public domain</a>).
</em></figcaption>
</figure></div>
<div class="section" id="import-packages">
<h2>Import packages<a class="headerlink" href="#import-packages" title="Permalink to this headline">¶</a></h2>
<p>Start by loading everything we need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The standard Python science stack</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="c1"># For projections (wrapped for Proj)</span>
<span class="kn">import</span> <span class="nn">pyproj</span>

<span class="c1"># Plotting maps using GMT</span>
<span class="kn">import</span> <span class="nn">pygmt</span>

<span class="c1"># The Fatiando stack</span>
<span class="kn">import</span> <span class="nn">ensaio</span>
<span class="kn">import</span> <span class="nn">pooch</span>
<span class="kn">import</span> <span class="nn">verde</span> <span class="k">as</span> <span class="nn">vd</span>
<span class="kn">import</span> <span class="nn">boule</span> <span class="k">as</span> <span class="nn">bl</span>
<span class="kn">import</span> <span class="nn">harmonica</span> <span class="k">as</span> <span class="nn">hm</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fetch-the-data">
<h2>Fetch the data<a class="headerlink" href="#fetch-the-data" title="Permalink to this headline">¶</a></h2>
<p>The three data sets required are:</p>
<ul class="simple">
<li><p>Gravity</p></li>
<li><p>Topography</p></li>
<li><p>Global geoid model</p></li>
</ul>
<p>The global geoid model (co-registered with our topography grid) will be use to convert the topography from orthometric (referenced to “sea level” or the geoid) to geometric (referenced to the WGS84 ellipsoid) heights. This conversion is required to calculate gravity disturbances instead of anomalies (more on that below).</p>
<p>For downloading the data we can use two options: using <strong>Ensaio</strong> or using directly <strong>Pooch</strong>.</p>
<div class="section" id="downloading-data-using-ensaio">
<h3>Downloading data using Ensaio<a class="headerlink" href="#downloading-data-using-ensaio" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/fatiando/ensaio">Ensaio</a> (Portuguese for “rehearsal”) is a Python package for downloading open-access sample datasets for Geoscience, specifically from the <a class="reference external" href="https://github.com/fatiando-data">Fatiando a Terra Datasets</a> collection. To see available datasets with a short description of each, you can visit the <a class="reference external" href="https://www.fatiando.org/ensaio/latest/gallery/index.html">documentation</a>.
Ensaio provides functions for downloading datasets from to your computer. These functions don’t attempt to do any loading of the data into memory and only return the path of the downloaded file on your computer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path_gravity</span> <span class="o">=</span> <span class="n">ensaio</span><span class="o">.</span><span class="n">fetch_southern_africa_gravity</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">path_topography</span> <span class="o">=</span> <span class="n">ensaio</span><span class="o">.</span><span class="n">fetch_earth_topography</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">path_geoid</span>  <span class="o">=</span> <span class="n">ensaio</span><span class="o">.</span><span class="n">fetch_earth_geoid</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">path_gravity</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path_topography</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">path_geoid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/m/.cache/ensaio/v1/southern-africa-gravity.csv.xz
/home/m/.cache/ensaio/v1/earth-topography-10arcmin.nc
/home/m/.cache/ensaio/v1/earth-geoid-10arcmin.nc
</pre></div>
</div>
</div>
</div>
<p>Ensaio uses <a class="reference external" href="https://www.fatiando.org/pooch">Pooch</a> under the hood to manage downloading and caching the data on your computer. Therefore, the other option is to use <em>Pooch</em> directly.</p>
</div>
<div class="section" id="downloading-data-using-pooch">
<h3>Downloading data using Pooch<a class="headerlink" href="#downloading-data-using-pooch" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://www.fatiando.org/pooch">Pooch</a> is a more general tool to download data files from anywhere on the web and store them locally for reuse. It is used to manage sample data downloads not only by our own tools but also other popular Scientific Python libraries like <a class="reference external" href="https://github.com/scikit-image/scikit-image">scikit-image</a>, <a class="reference external" href="https://github.com/pydata/xarray">xarray</a> among others.
To download the data from our <a class="reference external" href="https://zenodo.org/record/5167357#.YiJYLOiIaHs">curated sample datasets</a> stored on <a class="reference external" href="https://zenodo.org/">Zenodo</a> we need the Digital Object Identifier (DOI) of the Zenodo data archive:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>doi = &quot;10.5281/zenodo.5167357&quot;
path_gravity = pooch.retrieve(
    f&quot;doi:{doi}/southern-africa-gravity.csv.xz&quot;, 
    known_hash=&quot;md5:1dee324a14e647855366d6eb01a1ef35&quot;,
)
path_topography = pooch.retrieve(
    f&quot;doi:{doi}/earth-topography-10arcmin.nc&quot;, 
    known_hash=&quot;md5:c43b61322e03669c4313ba3d9a58028d&quot;,
)
path_geoid = pooch.retrieve(
    f&quot;doi:{doi}/earth-geoid-10arcmin.nc&quot;, 
    known_hash=&quot;md5:39b97344e704eb68fa381df2eb47da0f&quot;,
)
print(path_gravity)
print(path_topography)
print(path_geoid)
</pre></div>
</div>
<p>Whether you use Ensaio or Pooch directly, you will have the same datasets, the only difference is in the paths to the location of the files.</p>
</div>
</div>
<div class="section" id="load-the-data">
<h2>Load the data<a class="headerlink" href="#load-the-data" title="Permalink to this headline">¶</a></h2>
<p>Now that the data files have been downloaded and cached to our computer, we can use standard Python libraries to load the data.</p>
<p>Use <a class="reference external" href="https://pandas.pydata.org/">Pandas</a> to read the gravity data from the compressed CSV file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_gravity</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18.34444</td>
      <td>-34.12971</td>
      <td>32.2</td>
      <td>979656.12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18.36028</td>
      <td>-34.08833</td>
      <td>592.5</td>
      <td>979508.21</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.37418</td>
      <td>-34.19583</td>
      <td>18.4</td>
      <td>979666.46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.40388</td>
      <td>-34.23972</td>
      <td>25.0</td>
      <td>979671.03</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18.41112</td>
      <td>-34.16444</td>
      <td>228.7</td>
      <td>979616.11</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14354</th>
      <td>21.22500</td>
      <td>-17.95833</td>
      <td>1053.1</td>
      <td>978182.09</td>
    </tr>
    <tr>
      <th>14355</th>
      <td>21.27500</td>
      <td>-17.98333</td>
      <td>1033.3</td>
      <td>978183.09</td>
    </tr>
    <tr>
      <th>14356</th>
      <td>21.70833</td>
      <td>-17.99166</td>
      <td>1041.8</td>
      <td>978182.69</td>
    </tr>
    <tr>
      <th>14357</th>
      <td>21.85000</td>
      <td>-17.95833</td>
      <td>1033.3</td>
      <td>978193.18</td>
    </tr>
    <tr>
      <th>14358</th>
      <td>21.98333</td>
      <td>-17.94166</td>
      <td>1022.6</td>
      <td>978211.38</td>
    </tr>
  </tbody>
</table>
<p>14359 rows × 4 columns</p>
</div></div></div>
</div>
<p>And use <a class="reference external" href="https://xarray.pydata.org/">xarray</a> to read the topography and geoid grids from the netCDF files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topography</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataarray</span><span class="p">(</span><span class="n">path_topography</span><span class="p">)</span>
<span class="n">topography</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;topography&#x27; (latitude: 1081, longitude: 2161)&gt;
array([[ 2742.,  2742.,  2742., ...,  2742.,  2742.,  2742.],
       [ 2768.,  2768.,  2768., ...,  2768.,  2768.,  2768.],
       [ 2822.,  2822.,  2821., ...,  2822.,  2822.,  2822.],
       ...,
       [-4243., -4244., -4245., ..., -4242., -4243., -4243.],
       [-4156., -4157., -4157., ..., -4156., -4156., -4156.],
       [-4237., -4237., -4237., ..., -4237., -4237., -4237.]],
      dtype=float32)
Coordinates:
  * longitude  (longitude) float64 -180.0 -179.8 -179.7 ... 179.7 179.8 180.0
  * latitude   (latitude) float64 -90.0 -89.83 -89.67 -89.5 ... 89.67 89.83 90.0
Attributes:
    Conventions:     CF-1.8
    title:           Topographic and bathymetric height of ETOPO1 (ice surfac...
    crs:             WGS84
    source:          Generated from a spherical harmonic model by the ICGEM C...
    license:         public domain
    references:      https://doi.org/10.7289/V5C8276M
    long_name:       topographic height above mean sea level
    standard_name:   height_above_mean_sea_level
    description:     height topography/bathymetry referenced to mean sea level
    units:           m
    actual_range:    [-10023.   6082.]
    icgem_metadata:  generating_institute: gfz-potsdam\ngenerating_date: 2021...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'topography'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 1081</li><li><span class='xr-has-index'>longitude</span>: 2161</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a9534816-7261-40ba-85dc-a5fca53066e6' class='xr-array-in' type='checkbox' checked><label for='section-a9534816-7261-40ba-85dc-a5fca53066e6' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2.742e+03 2.742e+03 2.742e+03 ... -4.237e+03 -4.237e+03 -4.237e+03</span></div><div class='xr-array-data'><pre>array([[ 2742.,  2742.,  2742., ...,  2742.,  2742.,  2742.],
       [ 2768.,  2768.,  2768., ...,  2768.,  2768.,  2768.],
       [ 2822.,  2822.,  2821., ...,  2822.,  2822.,  2822.],
       ...,
       [-4243., -4244., -4245., ..., -4242., -4243., -4243.],
       [-4156., -4157., -4157., ..., -4156., -4156., -4156.],
       [-4237., -4237., -4237., ..., -4237., -4237., -4237.]],
      dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-c2473aac-42f7-459f-a304-2aa499caa081' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c2473aac-42f7-459f-a304-2aa499caa081' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.8 180.0</div><input id='attrs-fc2dd53f-22e0-4b2e-9ce1-be7408aee460' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc2dd53f-22e0-4b2e-9ce1-be7408aee460' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40f46e8e-c8a7-4e1e-86d0-2989d9b49c43' class='xr-var-data-in' type='checkbox'><label for='data-40f46e8e-c8a7-4e1e-86d0-2989d9b49c43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>[-180.  180.]</dd></dl></div><div class='xr-var-data'><pre>array([-180.      , -179.833333, -179.666667, ...,  179.666667,  179.833333,
        180.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.83 -89.67 ... 89.83 90.0</div><input id='attrs-060d9135-2a4c-4a7e-b571-cb306ad6dbfe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-060d9135-2a4c-4a7e-b571-cb306ad6dbfe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12c128b7-b4cb-478c-900d-6fb3a1eb41e3' class='xr-var-data-in' type='checkbox'><label for='data-12c128b7-b4cb-478c-900d-6fb3a1eb41e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -89.833333, -89.666667, ...,  89.666667,  89.833333,
        90.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f3c0c0af-6dee-4507-b9b2-37af64caaafd' class='xr-section-summary-in' type='checkbox'  ><label for='section-f3c0c0af-6dee-4507-b9b2-37af64caaafd' class='xr-section-summary' >Attributes: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>title :</span></dt><dd>Topographic and bathymetric height of ETOPO1 (ice surface) at 10 arc-minute resolution</dd><dt><span>crs :</span></dt><dd>WGS84</dd><dt><span>source :</span></dt><dd>Generated from a spherical harmonic model by the ICGEM Calculation Service (http://icgem.gfz-potsdam.de)</dd><dt><span>license :</span></dt><dd>public domain</dd><dt><span>references :</span></dt><dd>https://doi.org/10.7289/V5C8276M</dd><dt><span>long_name :</span></dt><dd>topographic height above mean sea level</dd><dt><span>standard_name :</span></dt><dd>height_above_mean_sea_level</dd><dt><span>description :</span></dt><dd>height topography/bathymetry referenced to mean sea level</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>actual_range :</span></dt><dd>[-10023.   6082.]</dd><dt><span>icgem_metadata :</span></dt><dd>generating_institute: gfz-potsdam
generating_date: 2021/06/11
product_type: topography
body: earth
modelname: etopo1-2250
max_used_degree: 720
gentlecut: 540 to 720
functional: topography_shm (from shm)
unit: meter
refsysname: WGS84
radiusrefsys: 6378137.000 m
flatrefsys: 3.352810664747480E-03 (1/298.25722356300)
long_lat_unit: degree
latlimit_north: 90.000000000000
latlimit_south: -90.000000000000
longlimit_west: -180.00000000000
longlimit_east: 180.00000000000
gridstep: 0.16666666666667
latitude_parallels: 1081
longitude_parallels: 2161
number_of_gridpoints: 2336041
gapvalue: 99999.0000
weighted_mean: -2.3852244E+03 meter
maxvalue: 6.0816327E+03 meter
minvalue: -1.0023309E+04 meter
signal_wrms: 2.5003302E+03 meter
grid_format: long_lat_value
attributes: longitude latitude topography_shm
attributes_units: deg. deg. meter</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geoid</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">load_dataarray</span><span class="p">(</span><span class="n">path_geoid</span><span class="p">)</span>
<span class="n">geoid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;geoid&#x27; (latitude: 1081, longitude: 2161)&gt;
array([[-29.5     , -29.5     , -29.5     , ..., -29.5     , -29.5     ,
        -29.5     ],
       [-29.5     , -29.5     , -29.5     , ..., -29.5     , -29.5     ,
        -29.5     ],
       [-29.6     , -29.6     , -29.6     , ..., -29.6     , -29.6     ,
        -29.6     ],
       ...,
       [ 14.7     ,  14.7     ,  14.7     , ...,  14.7     ,  14.7     ,
         14.7     ],
       [ 15.2     ,  15.2     ,  15.2     , ...,  15.2     ,  15.2     ,
         15.2     ],
       [ 15.400001,  15.400001,  15.400001, ...,  15.400001,  15.400001,
         15.400001]], dtype=float32)
Coordinates:
  * longitude  (longitude) float64 -180.0 -179.8 -179.7 ... 179.7 179.8 180.0
  * latitude   (latitude) float64 -90.0 -89.83 -89.67 -89.5 ... 89.67 89.83 90.0
Attributes:
    Conventions:     CF-1.8
    title:           Geoid height (EIGEN-6C4) with respect to WGS84
    crs:             WGS84
    source:          Generated from the EIGEN-6C4 model by the ICGEM Calculat...
    license:         Creative Commons Attribution 4.0 International Licence
    references:      https://doi.org/10.5880/icgem.2015.1
    long_name:       geoid height
    standard_name:   geoid_height_above_reference_ellipsoid
    description:     height of the geoid with respect to the WGS84 ellipsoid
    units:           m
    actual_range:    [-106.5   86. ]
    icgem_metadata:  generating_institute: gfz-potsdam\ngenerating_date: 2021...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'geoid'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 1081</li><li><span class='xr-has-index'>longitude</span>: 2161</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-5d467e99-93ed-49f4-b47c-025411718f83' class='xr-array-in' type='checkbox' checked><label for='section-5d467e99-93ed-49f4-b47c-025411718f83' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-29.5 -29.5 -29.5 -29.5 -29.5 -29.5 ... 15.4 15.4 15.4 15.4 15.4 15.4</span></div><div class='xr-array-data'><pre>array([[-29.5     , -29.5     , -29.5     , ..., -29.5     , -29.5     ,
        -29.5     ],
       [-29.5     , -29.5     , -29.5     , ..., -29.5     , -29.5     ,
        -29.5     ],
       [-29.6     , -29.6     , -29.6     , ..., -29.6     , -29.6     ,
        -29.6     ],
       ...,
       [ 14.7     ,  14.7     ,  14.7     , ...,  14.7     ,  14.7     ,
         14.7     ],
       [ 15.2     ,  15.2     ,  15.2     , ...,  15.2     ,  15.2     ,
         15.2     ],
       [ 15.400001,  15.400001,  15.400001, ...,  15.400001,  15.400001,
         15.400001]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-f9c6d777-4f13-4cce-826f-1617a662ed98' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f9c6d777-4f13-4cce-826f-1617a662ed98' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.8 180.0</div><input id='attrs-7cc0b5ff-4f7d-4bb1-bc38-1d1928e6eff7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7cc0b5ff-4f7d-4bb1-bc38-1d1928e6eff7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32ce7c25-2b2f-4e13-895c-dbcbbe696ce2' class='xr-var-data-in' type='checkbox'><label for='data-32ce7c25-2b2f-4e13-895c-dbcbbe696ce2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>[-180.  180.]</dd></dl></div><div class='xr-var-data'><pre>array([-180.      , -179.833333, -179.666667, ...,  179.666667,  179.833333,
        180.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.83 -89.67 ... 89.83 90.0</div><input id='attrs-13655461-8c7a-4113-906a-1fe850e36be6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-13655461-8c7a-4113-906a-1fe850e36be6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2da1adc-bd16-4434-8e78-5d91aefa7d8c' class='xr-var-data-in' type='checkbox'><label for='data-b2da1adc-bd16-4434-8e78-5d91aefa7d8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-90.      , -89.833333, -89.666667, ...,  89.666667,  89.833333,
        90.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2d1f817f-e7fd-4f3a-95d1-e7d05685ab73' class='xr-section-summary-in' type='checkbox'  ><label for='section-2d1f817f-e7fd-4f3a-95d1-e7d05685ab73' class='xr-section-summary' >Attributes: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>title :</span></dt><dd>Geoid height (EIGEN-6C4) with respect to WGS84</dd><dt><span>crs :</span></dt><dd>WGS84</dd><dt><span>source :</span></dt><dd>Generated from the EIGEN-6C4 model by the ICGEM Calculation Service (http://icgem.gfz-potsdam.de)</dd><dt><span>license :</span></dt><dd>Creative Commons Attribution 4.0 International Licence</dd><dt><span>references :</span></dt><dd>https://doi.org/10.5880/icgem.2015.1</dd><dt><span>long_name :</span></dt><dd>geoid height</dd><dt><span>standard_name :</span></dt><dd>geoid_height_above_reference_ellipsoid</dd><dt><span>description :</span></dt><dd>height of the geoid with respect to the WGS84 ellipsoid</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>actual_range :</span></dt><dd>[-106.5   86. ]</dd><dt><span>icgem_metadata :</span></dt><dd>generating_institute: gfz-potsdam
generating_date: 2021/06/11
product_type: gravity_field
body: earth
modelname: EIGEN-6C4
max_used_degree: 720
gentlecut: 540 to 720
tide_system: tide_free
functional: geoid
zero_degree_term: included
unit: meter
crust_density: 2670.0 kg/m**3
refsysname: WGS84
gmrefpot: 3.98600441800E+14 m**3/s**2
radiusrefpot: 6378137.000 m
flatrefpot: 3.352810664747480E-03 (1/298.25722356300)
omegarefpot: 7.29211500000E-05 1/s
normal_potential: 6.263685171456948E+07 m**2/s**2
long_lat_unit: degree
latlimit_north: 90.000000000000
latlimit_south: -90.000000000000
longlimit_west: -180.00000000000
longlimit_east: 180.00000000000
gridstep: 0.16666666666667
latitude_parallels: 1081
longitude_parallels: 2161
number_of_gridpoints: 2336041
gapvalue: 999.0000
weighted_mean: -5.2816814E-02 meter
maxvalue: 8.5964166E+01 meter
minvalue: -1.0652440E+02 meter
signal_wrms: 3.0591615E+01 meter
grid_format: long_lat_value
attributes: longitude latitude geoid
attributes_units: deg. deg. meter</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="crop-the-data-to-the-bushveld">
<h2>Crop the data to the Bushveld<a class="headerlink" href="#crop-the-data-to-the-bushveld" title="Permalink to this headline">¶</a></h2>
<p>The grids are global and the gravity data covers all of Southern Africa. So before we start working we’ll need to crop the data to the immediate region around the Bushveld complex. For the topography and geoid grids, we’ll use a larger region to avoid edge effects in the topographic correction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># West, East, South, North (degrees)</span>
<span class="n">region</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">27</span><span class="p">,</span> <span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="c1"># Pad the region for slicing the grids</span>
<span class="n">region_pad</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">pad_region</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To slice a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>, we can use <a class="reference external" href="https://www.fatiando.org/verde/">Verde</a>’s <code class="docutils literal notranslate"><span class="pre">inside</span></code> function to get the index of all points falling inside the given region.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">vd</span><span class="o">.</span><span class="n">inside</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span> <span class="n">region</span><span class="p">)]</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8648</th>
      <td>25.01500</td>
      <td>-26.26334</td>
      <td>1230.2</td>
      <td>978681.38</td>
    </tr>
    <tr>
      <th>8649</th>
      <td>25.01932</td>
      <td>-26.38713</td>
      <td>1297.0</td>
      <td>978669.02</td>
    </tr>
    <tr>
      <th>8650</th>
      <td>25.02499</td>
      <td>-26.39667</td>
      <td>1304.8</td>
      <td>978669.28</td>
    </tr>
    <tr>
      <th>8651</th>
      <td>25.04500</td>
      <td>-26.07668</td>
      <td>1165.2</td>
      <td>978681.08</td>
    </tr>
    <tr>
      <th>8652</th>
      <td>25.07668</td>
      <td>-26.35001</td>
      <td>1262.5</td>
      <td>978665.19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12974</th>
      <td>31.51500</td>
      <td>-23.86333</td>
      <td>300.5</td>
      <td>978776.85</td>
    </tr>
    <tr>
      <th>12975</th>
      <td>31.52499</td>
      <td>-23.30000</td>
      <td>280.7</td>
      <td>978798.55</td>
    </tr>
    <tr>
      <th>12976</th>
      <td>31.54832</td>
      <td>-23.19333</td>
      <td>245.7</td>
      <td>978803.55</td>
    </tr>
    <tr>
      <th>12977</th>
      <td>31.57333</td>
      <td>-23.84833</td>
      <td>226.8</td>
      <td>978808.44</td>
    </tr>
    <tr>
      <th>13557</th>
      <td>31.37500</td>
      <td>-23.00000</td>
      <td>285.6</td>
      <td>978734.77</td>
    </tr>
  </tbody>
</table>
<p>3877 rows × 4 columns</p>
</div></div></div>
</div>
<p>For the grids, we use the <code class="docutils literal notranslate"><span class="pre">sel</span></code> method of the <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> objects directly (one of the many perks of using xarray for gridded data).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geoid</span> <span class="o">=</span> <span class="n">geoid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">region_pad</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">region_pad</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>
<span class="n">topography</span> <span class="o">=</span> <span class="n">topography</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">region_pad</span><span class="p">[:</span><span class="mi">2</span><span class="p">]),</span> <span class="n">latitude</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">region_pad</span><span class="p">[</span><span class="mi">2</span><span class="p">:]))</span>
<span class="n">topography</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;topography&#x27; (latitude: 85, longitude: 103)&gt;
array([[ 1013.,  1236.,  1335., ..., -3867., -4446., -4842.],
       [ 1206.,  1270.,  1227., ..., -3790., -4350., -4736.],
       [ 1245.,  1197.,  1104., ..., -3847., -4362., -4703.],
       ...,
       [ 1128.,  1123.,  1113., ...,    -7.,   -32.,   -18.],
       [ 1115.,  1107.,  1098., ...,    17.,   -10.,   -21.],
       [ 1102.,  1094.,  1084., ...,    18.,     9.,   -13.]],
      dtype=float32)
Coordinates:
  * longitude  (longitude) float64 20.0 20.17 20.33 20.5 ... 36.67 36.83 37.0
  * latitude   (latitude) float64 -32.0 -31.83 -31.67 ... -18.33 -18.17 -18.0
Attributes:
    Conventions:     CF-1.8
    title:           Topographic and bathymetric height of ETOPO1 (ice surfac...
    crs:             WGS84
    source:          Generated from a spherical harmonic model by the ICGEM C...
    license:         public domain
    references:      https://doi.org/10.7289/V5C8276M
    long_name:       topographic height above mean sea level
    standard_name:   height_above_mean_sea_level
    description:     height topography/bathymetry referenced to mean sea level
    units:           m
    actual_range:    [-10023.   6082.]
    icgem_metadata:  generating_institute: gfz-potsdam\ngenerating_date: 2021...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'topography'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 85</li><li><span class='xr-has-index'>longitude</span>: 103</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-cfd04c3e-2e82-4655-9f60-5ba0992b7ee0' class='xr-array-in' type='checkbox' checked><label for='section-cfd04c3e-2e82-4655-9f60-5ba0992b7ee0' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.013e+03 1.236e+03 1.335e+03 1.344e+03 ... -2.0 18.0 9.0 -13.0</span></div><div class='xr-array-data'><pre>array([[ 1013.,  1236.,  1335., ..., -3867., -4446., -4842.],
       [ 1206.,  1270.,  1227., ..., -3790., -4350., -4736.],
       [ 1245.,  1197.,  1104., ..., -3847., -4362., -4703.],
       ...,
       [ 1128.,  1123.,  1113., ...,    -7.,   -32.,   -18.],
       [ 1115.,  1107.,  1098., ...,    17.,   -10.,   -21.],
       [ 1102.,  1094.,  1084., ...,    18.,     9.,   -13.]],
      dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-5eb4beea-1255-4601-b0a4-ad3d983c50eb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5eb4beea-1255-4601-b0a4-ad3d983c50eb' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>20.0 20.17 20.33 ... 36.83 37.0</div><input id='attrs-71327d6f-2396-49bc-babe-28cde016bd77' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-71327d6f-2396-49bc-babe-28cde016bd77' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f19ddc9-558d-4e97-9e79-c263ba09146d' class='xr-var-data-in' type='checkbox'><label for='data-2f19ddc9-558d-4e97-9e79-c263ba09146d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>actual_range :</span></dt><dd>[-180.  180.]</dd></dl></div><div class='xr-var-data'><pre>array([20.      , 20.166667, 20.333333, 20.5     , 20.666667, 20.833333,
       21.      , 21.166667, 21.333333, 21.5     , 21.666667, 21.833333,
       22.      , 22.166667, 22.333333, 22.5     , 22.666667, 22.833333,
       23.      , 23.166667, 23.333333, 23.5     , 23.666667, 23.833333,
       24.      , 24.166667, 24.333333, 24.5     , 24.666667, 24.833333,
       25.      , 25.166667, 25.333333, 25.5     , 25.666667, 25.833333,
       26.      , 26.166667, 26.333333, 26.5     , 26.666667, 26.833333,
       27.      , 27.166667, 27.333333, 27.5     , 27.666667, 27.833333,
       28.      , 28.166667, 28.333333, 28.5     , 28.666667, 28.833333,
       29.      , 29.166667, 29.333333, 29.5     , 29.666667, 29.833333,
       30.      , 30.166667, 30.333333, 30.5     , 30.666667, 30.833333,
       31.      , 31.166667, 31.333333, 31.5     , 31.666667, 31.833333,
       32.      , 32.166667, 32.333333, 32.5     , 32.666667, 32.833333,
       33.      , 33.166667, 33.333333, 33.5     , 33.666667, 33.833333,
       34.      , 34.166667, 34.333333, 34.5     , 34.666667, 34.833333,
       35.      , 35.166667, 35.333333, 35.5     , 35.666667, 35.833333,
       36.      , 36.166667, 36.333333, 36.5     , 36.666667, 36.833333,
       37.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-32.0 -31.83 ... -18.17 -18.0</div><input id='attrs-7023251d-1dcf-42a3-abb5-6db322edd996' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7023251d-1dcf-42a3-abb5-6db322edd996' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-68dff47a-0305-4385-b2b4-08df2615d1d8' class='xr-var-data-in' type='checkbox'><label for='data-68dff47a-0305-4385-b2b4-08df2615d1d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>actual_range :</span></dt><dd>[-90.  90.]</dd></dl></div><div class='xr-var-data'><pre>array([-32.      , -31.833333, -31.666667, -31.5     , -31.333333, -31.166667,
       -31.      , -30.833333, -30.666667, -30.5     , -30.333333, -30.166667,
       -30.      , -29.833333, -29.666667, -29.5     , -29.333333, -29.166667,
       -29.      , -28.833333, -28.666667, -28.5     , -28.333333, -28.166667,
       -28.      , -27.833333, -27.666667, -27.5     , -27.333333, -27.166667,
       -27.      , -26.833333, -26.666667, -26.5     , -26.333333, -26.166667,
       -26.      , -25.833333, -25.666667, -25.5     , -25.333333, -25.166667,
       -25.      , -24.833333, -24.666667, -24.5     , -24.333333, -24.166667,
       -24.      , -23.833333, -23.666667, -23.5     , -23.333333, -23.166667,
       -23.      , -22.833333, -22.666667, -22.5     , -22.333333, -22.166667,
       -22.      , -21.833333, -21.666667, -21.5     , -21.333333, -21.166667,
       -21.      , -20.833333, -20.666667, -20.5     , -20.333333, -20.166667,
       -20.      , -19.833333, -19.666667, -19.5     , -19.333333, -19.166667,
       -19.      , -18.833333, -18.666667, -18.5     , -18.333333, -18.166667,
       -18.      ])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0856e7b3-3d47-41f8-ba1e-5a16562e1aa5' class='xr-section-summary-in' type='checkbox'  ><label for='section-0856e7b3-3d47-41f8-ba1e-5a16562e1aa5' class='xr-section-summary' >Attributes: <span>(12)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8</dd><dt><span>title :</span></dt><dd>Topographic and bathymetric height of ETOPO1 (ice surface) at 10 arc-minute resolution</dd><dt><span>crs :</span></dt><dd>WGS84</dd><dt><span>source :</span></dt><dd>Generated from a spherical harmonic model by the ICGEM Calculation Service (http://icgem.gfz-potsdam.de)</dd><dt><span>license :</span></dt><dd>public domain</dd><dt><span>references :</span></dt><dd>https://doi.org/10.7289/V5C8276M</dd><dt><span>long_name :</span></dt><dd>topographic height above mean sea level</dd><dt><span>standard_name :</span></dt><dd>height_above_mean_sea_level</dd><dt><span>description :</span></dt><dd>height topography/bathymetry referenced to mean sea level</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>actual_range :</span></dt><dd>[-10023.   6082.]</dd><dt><span>icgem_metadata :</span></dt><dd>generating_institute: gfz-potsdam
generating_date: 2021/06/11
product_type: topography
body: earth
modelname: etopo1-2250
max_used_degree: 720
gentlecut: 540 to 720
functional: topography_shm (from shm)
unit: meter
refsysname: WGS84
radiusrefsys: 6378137.000 m
flatrefsys: 3.352810664747480E-03 (1/298.25722356300)
long_lat_unit: degree
latlimit_north: 90.000000000000
latlimit_south: -90.000000000000
longlimit_west: -180.00000000000
longlimit_east: 180.00000000000
gridstep: 0.16666666666667
latitude_parallels: 1081
longitude_parallels: 2161
number_of_gridpoints: 2336041
gapvalue: 99999.0000
weighted_mean: -2.3852244E+03 meter
maxvalue: 6.0816327E+03 meter
minvalue: -1.0023309E+04 meter
signal_wrms: 2.5003302E+03 meter
grid_format: long_lat_value
attributes: longitude latitude topography_shm
attributes_units: deg. deg. meter</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="plot-the-data">
<h2>Plot the data<a class="headerlink" href="#plot-the-data" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="https://www.pygmt.org">PyGMT</a> to plot the data so we can see what we have. PyGMT is particularly well suited for dealing with spatial data, maps, and projections.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_mgal</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">gravity_mgal</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_mgal</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c4p&quot;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;M15c&quot;</span><span class="p">,</span> 
    <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;afg&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;observed gravity [mGal]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_23_0.png" src="../../_images/gravity-processing_23_0.png" />
</div>
</div>
<p>Also plot the topography grid with the data points overlaid so we can get a sense for how much topographic variation there is and how much we padded the grids.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">grdimage</span><span class="p">(</span><span class="n">topography</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;M15c&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;etopo1&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;topography [m]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">coast</span><span class="p">(</span><span class="n">shorelines</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">area_thresh</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c0.04c&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_25_0.png" src="../../_images/gravity-processing_25_0.png" />
</div>
</div>
<blockquote>
<div><p><strong>NOTE: This topography grid is not ideal for use with gravity processing.</strong> The resolution of the grid is much coarser than our gravity data, which will cause under-correction when we remove the effect of the topography. For this example, we made the trade-off between a less-than-ideal dataset but one that is of manageable size. In practice, <strong>always try to match the spatial resolution of the data and topography grid</strong>.</p>
</div></blockquote>
</div>
<div class="section" id="project-the-grids-and-data">
<h2>Project the grids and data<a class="headerlink" href="#project-the-grids-and-data" title="Permalink to this headline">¶</a></h2>
<p>Since our study area is relatively small, we can use a map projection to transform our geographic data into a Cartesian coordinate system. This simplifies things like interpolation and topographic correction, which are often much faster if performed in Cartesian rather than spherical or geodetic coordinates.</p>
<p>We’ll use <a class="reference external" href="https://github.com/pyproj4/pyproj">pyproj</a> to create a Mercator projection function with latitude of true scale centered on the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">projection</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Proj</span><span class="p">(</span><span class="n">proj</span><span class="o">=</span><span class="s2">&quot;merc&quot;</span><span class="p">,</span> <span class="n">lat_ts</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>We can now use the <code class="docutils literal notranslate"><span class="pre">projection</span></code> to transform our gravity data and include the new coordinates in the <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">easting</span><span class="p">,</span> <span class="n">northing</span> <span class="o">=</span> <span class="n">projection</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">easting_m</span><span class="o">=</span><span class="n">easting</span><span class="p">,</span> <span class="n">northing_m</span><span class="o">=</span><span class="n">northing</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
      <th>easting_m</th>
      <th>northing_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8648</th>
      <td>25.01500</td>
      <td>-26.26334</td>
      <td>1230.2</td>
      <td>978681.38</td>
      <td>2.526066e+06</td>
      <td>-2.733052e+06</td>
    </tr>
    <tr>
      <th>8649</th>
      <td>25.01932</td>
      <td>-26.38713</td>
      <td>1297.0</td>
      <td>978669.02</td>
      <td>2.526503e+06</td>
      <td>-2.746924e+06</td>
    </tr>
    <tr>
      <th>8650</th>
      <td>25.02499</td>
      <td>-26.39667</td>
      <td>1304.8</td>
      <td>978669.28</td>
      <td>2.527075e+06</td>
      <td>-2.747994e+06</td>
    </tr>
    <tr>
      <th>8651</th>
      <td>25.04500</td>
      <td>-26.07668</td>
      <td>1165.2</td>
      <td>978681.08</td>
      <td>2.529096e+06</td>
      <td>-2.712163e+06</td>
    </tr>
    <tr>
      <th>8652</th>
      <td>25.07668</td>
      <td>-26.35001</td>
      <td>1262.5</td>
      <td>978665.19</td>
      <td>2.532295e+06</td>
      <td>-2.742763e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12974</th>
      <td>31.51500</td>
      <td>-23.86333</td>
      <td>300.5</td>
      <td>978776.85</td>
      <td>3.182450e+06</td>
      <td>-2.466945e+06</td>
    </tr>
    <tr>
      <th>12975</th>
      <td>31.52499</td>
      <td>-23.30000</td>
      <td>280.7</td>
      <td>978798.55</td>
      <td>3.183459e+06</td>
      <td>-2.405224e+06</td>
    </tr>
    <tr>
      <th>12976</th>
      <td>31.54832</td>
      <td>-23.19333</td>
      <td>245.7</td>
      <td>978803.55</td>
      <td>3.185814e+06</td>
      <td>-2.393567e+06</td>
    </tr>
    <tr>
      <th>12977</th>
      <td>31.57333</td>
      <td>-23.84833</td>
      <td>226.8</td>
      <td>978808.44</td>
      <td>3.188340e+06</td>
      <td>-2.465298e+06</td>
    </tr>
    <tr>
      <th>13557</th>
      <td>31.37500</td>
      <td>-23.00000</td>
      <td>285.6</td>
      <td>978734.77</td>
      <td>3.168312e+06</td>
      <td>-2.372463e+06</td>
    </tr>
  </tbody>
</table>
<p>3877 rows × 6 columns</p>
</div></div></div>
</div>
<p>Projecting the grids is more complicated since it involves some interpolation to maintain evenly spaced grid nodes. Verde provides the <code class="docutils literal notranslate"><span class="pre">project_grid</span></code> function that performs all of these calculations automatically for us. We’ll use nearest-neighbor interpolation here since it’s faster and our project doesn’t warp the data too much.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topography_proj</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">project_grid</span><span class="p">(</span><span class="n">topography</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<span class="n">geoid_proj</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">project_grid</span><span class="p">(</span><span class="n">geoid</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<span class="n">topography_proj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/m/anaconda3/envs/fatiando-tutorials/lib/python3.9/site-packages/verde/base/base_classes.py:463: FutureWarning: The &#39;spacing&#39;, &#39;shape&#39; and &#39;region&#39; arguments will be removed in Verde v2.0.0. Please use the &#39;verde.grid_coordinates&#39; function to define grid coordinates and pass them as the &#39;coordinates&#39; argument.
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/m/anaconda3/envs/fatiando-tutorials/lib/python3.9/site-packages/verde/base/base_classes.py:463: FutureWarning: The &#39;spacing&#39;, &#39;shape&#39; and &#39;region&#39; arguments will be removed in Verde v2.0.0. Please use the &#39;verde.grid_coordinates&#39; function to define grid coordinates and pass them as the &#39;coordinates&#39; argument.
  warnings.warn(
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;topography&#x27; (northing: 85, easting: 103)&gt;
array([[ 1.1245e+03,  1.1245e+03,  1.3350e+03, ..., -3.5210e+03,
        -4.4460e+03, -4.8420e+03],
       [ 1.2380e+03,  1.2380e+03,  1.2270e+03, ..., -3.4570e+03,
        -4.3500e+03, -4.7360e+03],
       [ 1.2210e+03,  1.2210e+03,  1.1040e+03, ..., -3.5170e+03,
        -4.3620e+03, -4.7030e+03],
       ...,
       [ 1.1255e+03,  1.1255e+03,  1.1130e+03, ...,  3.5000e+00,
        -3.2000e+01, -1.8000e+01],
       [ 1.1045e+03,  1.1045e+03,  1.0910e+03, ...,  1.1750e+01,
        -5.0000e-01, -1.7000e+01],
       [ 1.1045e+03,  1.1045e+03,  1.0910e+03, ...,  1.1750e+01,
        -5.0000e-01, -1.7000e+01]], dtype=float32)
Coordinates:
  * easting   (easting) float64 2.02e+06 2.036e+06 ... 3.72e+06 3.736e+06
  * northing  (northing) float64 -3.393e+06 -3.375e+06 ... -1.855e+06 -1.836e+06
Attributes:
    metadata:  Generated by Chain(steps=[(&#x27;mean&#x27;,\n              BlockReduce(...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'topography'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>northing</span>: 85</li><li><span class='xr-has-index'>easting</span>: 103</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9a4edcfe-b6e3-4e82-9ff3-59b24e400444' class='xr-array-in' type='checkbox' checked><label for='section-9a4edcfe-b6e3-4e82-9ff3-59b24e400444' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.124e+03 1.124e+03 1.335e+03 1.315e+03 ... 11.75 11.75 -0.5 -17.0</span></div><div class='xr-array-data'><pre>array([[ 1.1245e+03,  1.1245e+03,  1.3350e+03, ..., -3.5210e+03,
        -4.4460e+03, -4.8420e+03],
       [ 1.2380e+03,  1.2380e+03,  1.2270e+03, ..., -3.4570e+03,
        -4.3500e+03, -4.7360e+03],
       [ 1.2210e+03,  1.2210e+03,  1.1040e+03, ..., -3.5170e+03,
        -4.3620e+03, -4.7030e+03],
       ...,
       [ 1.1255e+03,  1.1255e+03,  1.1130e+03, ...,  3.5000e+00,
        -3.2000e+01, -1.8000e+01],
       [ 1.1045e+03,  1.1045e+03,  1.0910e+03, ...,  1.1750e+01,
        -5.0000e-01, -1.7000e+01],
       [ 1.1045e+03,  1.1045e+03,  1.0910e+03, ...,  1.1750e+01,
        -5.0000e-01, -1.7000e+01]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-4406b503-e5fa-40ac-acb1-668c86e727aa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4406b503-e5fa-40ac-acb1-668c86e727aa' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>easting</span></div><div class='xr-var-dims'>(easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.02e+06 2.036e+06 ... 3.736e+06</div><input id='attrs-53f2d0ba-02de-4ae0-9511-595965997929' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-53f2d0ba-02de-4ae0-9511-595965997929' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f87a7138-859f-439a-a3f7-029d2cbda975' class='xr-var-data-in' type='checkbox'><label for='data-f87a7138-859f-439a-a3f7-029d2cbda975' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019641.288106, 2036471.632173, 2053301.976241, 2070132.320308,
       2086962.664376, 2103793.008444, 2120623.352511, 2137453.696579,
       2154284.040646, 2171114.384714, 2187944.728781, 2204775.072849,
       2221605.416916, 2238435.760984, 2255266.105052, 2272096.449119,
       2288926.793187, 2305757.137254, 2322587.481322, 2339417.825389,
       2356248.169457, 2373078.513524, 2389908.857592, 2406739.201659,
       2423569.545727, 2440399.889795, 2457230.233862, 2474060.57793 ,
       2490890.921997, 2507721.266065, 2524551.610132, 2541381.9542  ,
       2558212.298267, 2575042.642335, 2591872.986403, 2608703.33047 ,
       2625533.674538, 2642364.018605, 2659194.362673, 2676024.70674 ,
       2692855.050808, 2709685.394875, 2726515.738943, 2743346.08301 ,
       2760176.427078, 2777006.771146, 2793837.115213, 2810667.459281,
       2827497.803348, 2844328.147416, 2861158.491483, 2877988.835551,
       2894819.179618, 2911649.523686, 2928479.867753, 2945310.211821,
       2962140.555889, 2978970.899956, 2995801.244024, 3012631.588091,
       3029461.932159, 3046292.276226, 3063122.620294, 3079952.964361,
       3096783.308429, 3113613.652497, 3130443.996564, 3147274.340632,
       3164104.684699, 3180935.028767, 3197765.372834, 3214595.716902,
       3231426.060969, 3248256.405037, 3265086.749104, 3281917.093172,
       3298747.43724 , 3315577.781307, 3332408.125375, 3349238.469442,
       3366068.81351 , 3382899.157577, 3399729.501645, 3416559.845712,
       3433390.18978 , 3450220.533847, 3467050.877915, 3483881.221983,
       3500711.56605 , 3517541.910118, 3534372.254185, 3551202.598253,
       3568032.94232 , 3584863.286388, 3601693.630455, 3618523.974523,
       3635354.318591, 3652184.662658, 3669015.006726, 3685845.350793,
       3702675.694861, 3719506.038928, 3736336.382996])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>northing</span></div><div class='xr-var-dims'>(northing)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.393e+06 ... -1.836e+06</div><input id='attrs-9a50f598-72b8-42a9-a95f-3837baa8e11d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a50f598-72b8-42a9-a95f-3837baa8e11d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-420945a2-6be3-4a48-aad6-216066e5298f' class='xr-var-data-in' type='checkbox'><label for='data-420945a2-6be3-4a48-aad6-216066e5298f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-3393301.457246, -3374766.496142, -3356231.535039, -3337696.573935,
       -3319161.612831, -3300626.651727, -3282091.690624, -3263556.72952 ,
       -3245021.768416, -3226486.807313, -3207951.846209, -3189416.885105,
       -3170881.924002, -3152346.962898, -3133812.001794, -3115277.04069 ,
       -3096742.079587, -3078207.118483, -3059672.157379, -3041137.196276,
       -3022602.235172, -3004067.274068, -2985532.312965, -2966997.351861,
       -2948462.390757, -2929927.429653, -2911392.46855 , -2892857.507446,
       -2874322.546342, -2855787.585239, -2837252.624135, -2818717.663031,
       -2800182.701927, -2781647.740824, -2763112.77972 , -2744577.818616,
       -2726042.857513, -2707507.896409, -2688972.935305, -2670437.974202,
       -2651903.013098, -2633368.051994, -2614833.09089 , -2596298.129787,
       -2577763.168683, -2559228.207579, -2540693.246476, -2522158.285372,
       -2503623.324268, -2485088.363165, -2466553.402061, -2448018.440957,
       -2429483.479853, -2410948.51875 , -2392413.557646, -2373878.596542,
       -2355343.635439, -2336808.674335, -2318273.713231, -2299738.752127,
       -2281203.791024, -2262668.82992 , -2244133.868816, -2225598.907713,
       -2207063.946609, -2188528.985505, -2169994.024402, -2151459.063298,
       -2132924.102194, -2114389.14109 , -2095854.179987, -2077319.218883,
       -2058784.257779, -2040249.296676, -2021714.335572, -2003179.374468,
       -1984644.413365, -1966109.452261, -1947574.491157, -1929039.530053,
       -1910504.56895 , -1891969.607846, -1873434.646742, -1854899.685639,
       -1836364.724535])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-84700de3-c089-490c-a831-d05ff043efa9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-84700de3-c089-490c-a831-d05ff043efa9' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>metadata :</span></dt><dd>Generated by Chain(steps=[(&#x27;mean&#x27;,
              BlockReduce(reduction=&lt;function mean at 0x7fd28c0fc9d0&gt;,
                          region=(2019641.2881058494, 3736336.3829958215,
                                  -3393301.4572460176, -1836364.7245348713),
                          spacing=(18534.961103704125, 16830.344067548747))),
             (&#x27;spline&#x27;, ScipyGridder(method=&#x27;nearest&#x27;))])</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="reference-heights-to-the-ellipsoid">
<h2>Reference heights to the ellipsoid<a class="headerlink" href="#reference-heights-to-the-ellipsoid" title="Permalink to this headline">¶</a></h2>
<p>Before we can calculate gravity disturbances, we need both the observation height and the topography to be referenced to the ellipsoid instead of “sea level” or the geoid. We can do that by adding the geoid height to the current heights.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">topography_geometric</span> <span class="o">=</span> <span class="n">topography_proj</span> <span class="o">+</span> <span class="n">geoid_proj</span>
<span class="n">topography_geometric</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (northing: 85, easting: 103)&gt;
array([[ 1.1603000e+03,  1.1603000e+03,  1.3718000e+03, ...,
        -3.4988999e+03, -4.4250000e+03, -4.8216001e+03],
       [ 1.2743000e+03,  1.2743000e+03,  1.2638000e+03, ...,
        -3.4351499e+03, -4.3292998e+03, -4.7158999e+03],
       [ 1.2573500e+03,  1.2573500e+03,  1.1406000e+03, ...,
        -3.4955000e+03, -4.3417002e+03, -4.6833999e+03],
       ...,
       [ 1.1438500e+03,  1.1438500e+03,  1.1305000e+03, ...,
        -5.0000000e+00, -4.0200001e+01, -2.6000000e+01],
       [ 1.1221500e+03,  1.1221500e+03,  1.1079000e+03, ...,
         2.5499992e+00, -9.3999996e+00, -2.5600000e+01],
       [ 1.1221500e+03,  1.1221500e+03,  1.1079000e+03, ...,
         2.5499992e+00, -9.3999996e+00, -2.5600000e+01]], dtype=float32)
Coordinates:
  * easting   (easting) float64 2.02e+06 2.036e+06 ... 3.72e+06 3.736e+06
  * northing  (northing) float64 -3.393e+06 -3.375e+06 ... -1.855e+06 -1.836e+06</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>northing</span>: 85</li><li><span class='xr-has-index'>easting</span>: 103</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f394f657-115d-4c78-8776-21a9a3288c7f' class='xr-array-in' type='checkbox' checked><label for='section-f394f657-115d-4c78-8776-21a9a3288c7f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.16e+03 1.16e+03 1.372e+03 1.352e+03 ... 2.55 2.55 -9.4 -25.6</span></div><div class='xr-array-data'><pre>array([[ 1.1603000e+03,  1.1603000e+03,  1.3718000e+03, ...,
        -3.4988999e+03, -4.4250000e+03, -4.8216001e+03],
       [ 1.2743000e+03,  1.2743000e+03,  1.2638000e+03, ...,
        -3.4351499e+03, -4.3292998e+03, -4.7158999e+03],
       [ 1.2573500e+03,  1.2573500e+03,  1.1406000e+03, ...,
        -3.4955000e+03, -4.3417002e+03, -4.6833999e+03],
       ...,
       [ 1.1438500e+03,  1.1438500e+03,  1.1305000e+03, ...,
        -5.0000000e+00, -4.0200001e+01, -2.6000000e+01],
       [ 1.1221500e+03,  1.1221500e+03,  1.1079000e+03, ...,
         2.5499992e+00, -9.3999996e+00, -2.5600000e+01],
       [ 1.1221500e+03,  1.1221500e+03,  1.1079000e+03, ...,
         2.5499992e+00, -9.3999996e+00, -2.5600000e+01]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-bee85cf7-6059-45ee-a291-5786233ee277' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bee85cf7-6059-45ee-a291-5786233ee277' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>easting</span></div><div class='xr-var-dims'>(easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.02e+06 2.036e+06 ... 3.736e+06</div><input id='attrs-cd2f286b-5d80-4e1d-a75b-c71423e74538' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cd2f286b-5d80-4e1d-a75b-c71423e74538' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a6e8fa9-cc6d-48d7-bb22-77b34461e7bc' class='xr-var-data-in' type='checkbox'><label for='data-7a6e8fa9-cc6d-48d7-bb22-77b34461e7bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019641.288106, 2036471.632173, 2053301.976241, 2070132.320308,
       2086962.664376, 2103793.008444, 2120623.352511, 2137453.696579,
       2154284.040646, 2171114.384714, 2187944.728781, 2204775.072849,
       2221605.416916, 2238435.760984, 2255266.105052, 2272096.449119,
       2288926.793187, 2305757.137254, 2322587.481322, 2339417.825389,
       2356248.169457, 2373078.513524, 2389908.857592, 2406739.201659,
       2423569.545727, 2440399.889795, 2457230.233862, 2474060.57793 ,
       2490890.921997, 2507721.266065, 2524551.610132, 2541381.9542  ,
       2558212.298267, 2575042.642335, 2591872.986403, 2608703.33047 ,
       2625533.674538, 2642364.018605, 2659194.362673, 2676024.70674 ,
       2692855.050808, 2709685.394875, 2726515.738943, 2743346.08301 ,
       2760176.427078, 2777006.771146, 2793837.115213, 2810667.459281,
       2827497.803348, 2844328.147416, 2861158.491483, 2877988.835551,
       2894819.179618, 2911649.523686, 2928479.867753, 2945310.211821,
       2962140.555889, 2978970.899956, 2995801.244024, 3012631.588091,
       3029461.932159, 3046292.276226, 3063122.620294, 3079952.964361,
       3096783.308429, 3113613.652497, 3130443.996564, 3147274.340632,
       3164104.684699, 3180935.028767, 3197765.372834, 3214595.716902,
       3231426.060969, 3248256.405037, 3265086.749104, 3281917.093172,
       3298747.43724 , 3315577.781307, 3332408.125375, 3349238.469442,
       3366068.81351 , 3382899.157577, 3399729.501645, 3416559.845712,
       3433390.18978 , 3450220.533847, 3467050.877915, 3483881.221983,
       3500711.56605 , 3517541.910118, 3534372.254185, 3551202.598253,
       3568032.94232 , 3584863.286388, 3601693.630455, 3618523.974523,
       3635354.318591, 3652184.662658, 3669015.006726, 3685845.350793,
       3702675.694861, 3719506.038928, 3736336.382996])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>northing</span></div><div class='xr-var-dims'>(northing)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.393e+06 ... -1.836e+06</div><input id='attrs-e99adf7a-cb89-43e7-b281-da954bec8c09' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e99adf7a-cb89-43e7-b281-da954bec8c09' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d4af9e8c-9e61-4fd5-b7b2-284f75e94f29' class='xr-var-data-in' type='checkbox'><label for='data-d4af9e8c-9e61-4fd5-b7b2-284f75e94f29' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-3393301.457246, -3374766.496142, -3356231.535039, -3337696.573935,
       -3319161.612831, -3300626.651727, -3282091.690624, -3263556.72952 ,
       -3245021.768416, -3226486.807313, -3207951.846209, -3189416.885105,
       -3170881.924002, -3152346.962898, -3133812.001794, -3115277.04069 ,
       -3096742.079587, -3078207.118483, -3059672.157379, -3041137.196276,
       -3022602.235172, -3004067.274068, -2985532.312965, -2966997.351861,
       -2948462.390757, -2929927.429653, -2911392.46855 , -2892857.507446,
       -2874322.546342, -2855787.585239, -2837252.624135, -2818717.663031,
       -2800182.701927, -2781647.740824, -2763112.77972 , -2744577.818616,
       -2726042.857513, -2707507.896409, -2688972.935305, -2670437.974202,
       -2651903.013098, -2633368.051994, -2614833.09089 , -2596298.129787,
       -2577763.168683, -2559228.207579, -2540693.246476, -2522158.285372,
       -2503623.324268, -2485088.363165, -2466553.402061, -2448018.440957,
       -2429483.479853, -2410948.51875 , -2392413.557646, -2373878.596542,
       -2355343.635439, -2336808.674335, -2318273.713231, -2299738.752127,
       -2281203.791024, -2262668.82992 , -2244133.868816, -2225598.907713,
       -2207063.946609, -2188528.985505, -2169994.024402, -2151459.063298,
       -2132924.102194, -2114389.14109 , -2095854.179987, -2077319.218883,
       -2058784.257779, -2040249.296676, -2021714.335572, -2003179.374468,
       -1984644.413365, -1966109.452261, -1947574.491157, -1929039.530053,
       -1910504.56895 , -1891969.607846, -1873434.646742, -1854899.685639,
       -1836364.724535])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a249e153-7558-40a1-ba59-6b10c58bc5cc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a249e153-7558-40a1-ba59-6b10c58bc5cc' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>For the observation heights, we have to interpolate the geoid height values at the same points as the observations. We can do this with the cubic interpolation in Verde.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unravel the grid so that we can pass it to the interpolator</span>
<span class="n">geoid_table</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">grid_to_table</span><span class="p">(</span><span class="n">geoid_proj</span><span class="p">)</span>
<span class="n">interpolator</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">ScipyGridder</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">)</span>
<span class="n">interpolator</span><span class="o">.</span><span class="n">fit</span><span class="p">((</span><span class="n">geoid_table</span><span class="o">.</span><span class="n">easting</span><span class="p">,</span> <span class="n">geoid_table</span><span class="o">.</span><span class="n">northing</span><span class="p">),</span> <span class="n">geoid_table</span><span class="o">.</span><span class="n">geoid</span><span class="p">)</span>
<span class="c1"># Predict the geoid height at same locations as the observation points</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">geoid_m</span><span class="o">=</span><span class="n">interpolator</span><span class="o">.</span><span class="n">predict</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">easting_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">northing_m</span><span class="p">)))</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">height_geometric_m</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">height_sea_level_m</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">geoid_m</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
      <th>easting_m</th>
      <th>northing_m</th>
      <th>geoid_m</th>
      <th>height_geometric_m</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8648</th>
      <td>25.01500</td>
      <td>-26.26334</td>
      <td>1230.2</td>
      <td>978681.38</td>
      <td>2.526066e+06</td>
      <td>-2.733052e+06</td>
      <td>27.302536</td>
      <td>1257.502536</td>
    </tr>
    <tr>
      <th>8649</th>
      <td>25.01932</td>
      <td>-26.38713</td>
      <td>1297.0</td>
      <td>978669.02</td>
      <td>2.526503e+06</td>
      <td>-2.746924e+06</td>
      <td>27.659737</td>
      <td>1324.659737</td>
    </tr>
    <tr>
      <th>8650</th>
      <td>25.02499</td>
      <td>-26.39667</td>
      <td>1304.8</td>
      <td>978669.28</td>
      <td>2.527075e+06</td>
      <td>-2.747994e+06</td>
      <td>27.689820</td>
      <td>1332.489820</td>
    </tr>
    <tr>
      <th>8651</th>
      <td>25.04500</td>
      <td>-26.07668</td>
      <td>1165.2</td>
      <td>978681.08</td>
      <td>2.529096e+06</td>
      <td>-2.712163e+06</td>
      <td>26.915163</td>
      <td>1192.115163</td>
    </tr>
    <tr>
      <th>8652</th>
      <td>25.07668</td>
      <td>-26.35001</td>
      <td>1262.5</td>
      <td>978665.19</td>
      <td>2.532295e+06</td>
      <td>-2.742763e+06</td>
      <td>27.540560</td>
      <td>1290.040560</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12974</th>
      <td>31.51500</td>
      <td>-23.86333</td>
      <td>300.5</td>
      <td>978776.85</td>
      <td>3.182450e+06</td>
      <td>-2.466945e+06</td>
      <td>12.527840</td>
      <td>313.027840</td>
    </tr>
    <tr>
      <th>12975</th>
      <td>31.52499</td>
      <td>-23.30000</td>
      <td>280.7</td>
      <td>978798.55</td>
      <td>3.183459e+06</td>
      <td>-2.405224e+06</td>
      <td>11.987479</td>
      <td>292.687479</td>
    </tr>
    <tr>
      <th>12976</th>
      <td>31.54832</td>
      <td>-23.19333</td>
      <td>245.7</td>
      <td>978803.55</td>
      <td>3.185814e+06</td>
      <td>-2.393567e+06</td>
      <td>11.897978</td>
      <td>257.597978</td>
    </tr>
    <tr>
      <th>12977</th>
      <td>31.57333</td>
      <td>-23.84833</td>
      <td>226.8</td>
      <td>978808.44</td>
      <td>3.188340e+06</td>
      <td>-2.465298e+06</td>
      <td>12.483330</td>
      <td>239.283330</td>
    </tr>
    <tr>
      <th>13557</th>
      <td>31.37500</td>
      <td>-23.00000</td>
      <td>285.6</td>
      <td>978734.77</td>
      <td>3.168312e+06</td>
      <td>-2.372463e+06</td>
      <td>11.533216</td>
      <td>297.133216</td>
    </tr>
  </tbody>
</table>
<p>3877 rows × 8 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="gravity-disturbance">
<h2>Gravity disturbance<a class="headerlink" href="#gravity-disturbance" title="Permalink to this headline">¶</a></h2>
<p>The gravity disturbance is defined as:</p>
<div class="math notranslate nohighlight">
\[
\delta g (\lambda, \phi, h) = g (\lambda, \phi, h) - \gamma (\lambda, \phi, h)
\]</div>
<p>in which <span class="math notranslate nohighlight">\((\lambda, \phi, h)\)</span> are the longitude, latitude, and geometric height, <span class="math notranslate nohighlight">\(g\)</span> is the observed gravity acceleration, and <span class="math notranslate nohighlight">\(\gamma\)</span> is the calculated <strong>normal gravity</strong> of a reference ellipsoid.
Notice that all 3 quantities are located at the same point (the observation point).</p>
<blockquote>
<div><p><strong>A note on disturbances vs anomalies:</strong> We want to calculate the disturbance <span class="math notranslate nohighlight">\(\delta g(\lambda, \phi, h)\)</span> instead of the traditional “gravity anomaly” <span class="math notranslate nohighlight">\(\Delta g(\lambda, \phi) = g(\lambda, \phi, h=N) - \gamma(\lambda, \phi, h=0)\)</span> because the anomaly is not exclusively related to the subsurface density anomalies, while the gravity disturbance is. In fact, it does not even make sense to talk about the “height of the gravity anomaly” since by definition it is only variable in longitude and latitude. Most geophysicists will agree that, in practice, the “height” of observations matter for modeling and interpretation. In most cases, even if we calculate gravity anomalies, we end up pretending that they are gravity disturbances when interpreting the data. So why not calculate disturbances directly?</p>
</div></blockquote>
<p>We can use <a class="reference external" href="https://www.fatiando.org/boule">Boule</a> to compute the <strong>normal gravity</strong> of the WGS84 reference ellipsoid on any point outside of the ellipsoid using a closed-form equation. This eliminates the need for a free-air correction, which is a rough approximation at best. With that, we can compute the gravity disturbance and store it in our <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">normal_gravity_mgal</span><span class="o">=</span><span class="n">bl</span><span class="o">.</span><span class="n">WGS84</span><span class="o">.</span><span class="n">normal_gravity</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">height_geometric_m</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">gravity_disturbance_mgal</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_mgal</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">normal_gravity_mgal</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
      <th>easting_m</th>
      <th>northing_m</th>
      <th>geoid_m</th>
      <th>height_geometric_m</th>
      <th>normal_gravity_mgal</th>
      <th>gravity_disturbance_mgal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8648</th>
      <td>25.01500</td>
      <td>-26.26334</td>
      <td>1230.2</td>
      <td>978681.38</td>
      <td>2.526066e+06</td>
      <td>-2.733052e+06</td>
      <td>27.302536</td>
      <td>1257.502536</td>
      <td>978656.289769</td>
      <td>25.090231</td>
    </tr>
    <tr>
      <th>8649</th>
      <td>25.01932</td>
      <td>-26.38713</td>
      <td>1297.0</td>
      <td>978669.02</td>
      <td>2.526503e+06</td>
      <td>-2.746924e+06</td>
      <td>27.659737</td>
      <td>1324.659737</td>
      <td>978644.455439</td>
      <td>24.564561</td>
    </tr>
    <tr>
      <th>8650</th>
      <td>25.02499</td>
      <td>-26.39667</td>
      <td>1304.8</td>
      <td>978669.28</td>
      <td>2.527075e+06</td>
      <td>-2.747994e+06</td>
      <td>27.689820</td>
      <td>1332.489820</td>
      <td>978642.725739</td>
      <td>26.554261</td>
    </tr>
    <tr>
      <th>8651</th>
      <td>25.04500</td>
      <td>-26.07668</td>
      <td>1165.2</td>
      <td>978681.08</td>
      <td>2.529096e+06</td>
      <td>-2.712163e+06</td>
      <td>26.915163</td>
      <td>1192.115163</td>
      <td>978663.122713</td>
      <td>17.957287</td>
    </tr>
    <tr>
      <th>8652</th>
      <td>25.07668</td>
      <td>-26.35001</td>
      <td>1262.5</td>
      <td>978665.19</td>
      <td>2.532295e+06</td>
      <td>-2.742763e+06</td>
      <td>27.540560</td>
      <td>1290.040560</td>
      <td>978652.468478</td>
      <td>12.721522</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12974</th>
      <td>31.51500</td>
      <td>-23.86333</td>
      <td>300.5</td>
      <td>978776.85</td>
      <td>3.182450e+06</td>
      <td>-2.466945e+06</td>
      <td>12.527840</td>
      <td>313.027840</td>
      <td>978781.535934</td>
      <td>-4.685934</td>
    </tr>
    <tr>
      <th>12975</th>
      <td>31.52499</td>
      <td>-23.30000</td>
      <td>280.7</td>
      <td>978798.55</td>
      <td>3.183459e+06</td>
      <td>-2.405224e+06</td>
      <td>11.987479</td>
      <td>292.687479</td>
      <td>978750.536972</td>
      <td>48.013028</td>
    </tr>
    <tr>
      <th>12976</th>
      <td>31.54832</td>
      <td>-23.19333</td>
      <td>245.7</td>
      <td>978803.55</td>
      <td>3.185814e+06</td>
      <td>-2.393567e+06</td>
      <td>11.897978</td>
      <td>257.597978</td>
      <td>978754.386590</td>
      <td>49.163410</td>
    </tr>
    <tr>
      <th>12977</th>
      <td>31.57333</td>
      <td>-23.84833</td>
      <td>226.8</td>
      <td>978808.44</td>
      <td>3.188340e+06</td>
      <td>-2.465298e+06</td>
      <td>12.483330</td>
      <td>239.283330</td>
      <td>978803.297086</td>
      <td>5.142914</td>
    </tr>
    <tr>
      <th>13557</th>
      <td>31.37500</td>
      <td>-23.00000</td>
      <td>285.6</td>
      <td>978734.77</td>
      <td>3.168312e+06</td>
      <td>-2.372463e+06</td>
      <td>11.533216</td>
      <td>297.133216</td>
      <td>978729.593092</td>
      <td>5.176908</td>
    </tr>
  </tbody>
</table>
<p>3877 rows × 10 columns</p>
</div></div></div>
</div>
<p>Now plot the gravity disturbance that we just calculated on a map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">maxabs</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_disturbance_mgal</span><span class="p">)</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar+h&quot;</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">maxabs</span><span class="p">,</span> <span class="n">maxabs</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_disturbance_mgal</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c4p&quot;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;M15c&quot;</span><span class="p">,</span> 
    <span class="n">frame</span><span class="o">=</span><span class="s2">&quot;af&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;gravity disturbance [mGal]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_40_0.png" src="../../_images/gravity-processing_40_0.png" />
</div>
</div>
</div>
<div class="section" id="topographic-correction">
<h2>Topographic correction<a class="headerlink" href="#topographic-correction" title="Permalink to this headline">¶</a></h2>
<p>Now that we have removed normal gravity and calculated a gravity disturbance, the next step is to remove the effect of the topographic and oceanic masses above and below the ellipsoid. We need to do this in order to isolate the effect of the Bushveld rocks.</p>
<p>We will use <a class="reference external" href="https://www.fatiando.org/harmonica">Harmonica</a> to calculate and remove the gravitational effect of the topography by modeling the masses as a layer of right-rectangular prisms.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">prism_layer</span></code> function creates a prism model based on a surface undulating around a reference level. In our case, the reference is the ellipsoid (0 height) and the surface is our topography (as geometric heights). The difficult part is assigning the correct density (or density contrast) to each part of our model:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho = 2670\ kg/m^3\)</span> for continental parts above the ellipsoid</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho = -2670\ kg/m^3\)</span> for continental parts below the ellipsoid</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho = 1040 - 2670\ kg/m^3\)</span> in the oceans (1040 being an approximate density of ocean water)</p></li>
</ul>
<p>Here we’ll define “continental” as places with positive orthometric height since 0 orthometric height roughly matches the coastlines.</p>
<figure>
<img src="images/topographic-correction.svg" alt="Sketch of the surfaces and masses involved in topographic correction of gravity disturbances.">
<figcaption><em>
    Sketch of the surfaces and masses involved in topographic correction of gravity disturbances. 
    (CC-BY).
</em></figcaption>
</figure>
<blockquote>
<div><p><strong>Note:</strong> There is an extra effect of under- and over-correcting for ocean water in the oceans. This happens because we are assuming that the surface of the water is at 0 geometric height (the surface of the ellipsoid) when in fact it roughly follows the geoid. So in oceanic places where the geoid is below the ellipsoid, we correct for water where there was none and vice-versa. Luckily, this effect is negligible here since our study area is relatively far away from the ocean. We can safely ignore this correction but it should be performed when close to the coast or directly above the oceans.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start by placing the continental density above and below the ellipsoid</span>
<span class="n">topography_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">topography_geometric</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2670</span><span class="p">,</span> <span class="o">-</span><span class="mi">2670</span><span class="p">)</span>
<span class="c1"># Now correct the value in the oceans (topography &lt; 0)</span>
<span class="n">topography_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">topography_proj</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1040</span> <span class="o">-</span> <span class="mi">2670</span><span class="p">,</span> <span class="n">topography_density</span><span class="p">)</span>
<span class="c1"># Create the prism model of the topographic masses</span>
<span class="n">topography_model</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">prism_layer</span><span class="p">(</span>
    <span class="n">coordinates</span><span class="o">=</span><span class="p">(</span><span class="n">topography_geometric</span><span class="o">.</span><span class="n">easting</span><span class="p">,</span> <span class="n">topography_geometric</span><span class="o">.</span><span class="n">northing</span><span class="p">),</span>
    <span class="n">surface</span><span class="o">=</span><span class="n">topography_geometric</span><span class="p">,</span>
    <span class="n">reference</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;density&quot;</span><span class="p">:</span> <span class="n">topography_density</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">topography_model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (northing: 85, easting: 103)
Coordinates:
  * easting   (easting) float64 2.02e+06 2.036e+06 ... 3.72e+06 3.736e+06
  * northing  (northing) float64 -3.393e+06 -3.375e+06 ... -1.855e+06 -1.836e+06
    top       (northing, easting) float32 1.16e+03 1.16e+03 ... 0.0 0.0
    bottom    (northing, easting) float64 0.0 0.0 0.0 0.0 ... 0.0 0.0 -9.4 -25.6
Data variables:
    density   (northing, easting) int64 2670 2670 2670 2670 ... 2670 -1630 -1630
Attributes:
    coords_units:      meters
    properties_units:  SI</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-0a2a45b2-377d-4694-800b-9844d3dfa8be' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0a2a45b2-377d-4694-800b-9844d3dfa8be' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>northing</span>: 85</li><li><span class='xr-has-index'>easting</span>: 103</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a47cbbf0-1e3f-424d-92e9-0aca852f7155' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a47cbbf0-1e3f-424d-92e9-0aca852f7155' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>easting</span></div><div class='xr-var-dims'>(easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.02e+06 2.036e+06 ... 3.736e+06</div><input id='attrs-ca9c48b5-a330-4e87-8fe6-e73d92989002' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ca9c48b5-a330-4e87-8fe6-e73d92989002' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-755b71ef-a702-44e5-9ce5-d6ec2103768d' class='xr-var-data-in' type='checkbox'><label for='data-755b71ef-a702-44e5-9ce5-d6ec2103768d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2019641.288106, 2036471.632173, 2053301.976241, 2070132.320308,
       2086962.664376, 2103793.008444, 2120623.352511, 2137453.696579,
       2154284.040646, 2171114.384714, 2187944.728781, 2204775.072849,
       2221605.416916, 2238435.760984, 2255266.105052, 2272096.449119,
       2288926.793187, 2305757.137254, 2322587.481322, 2339417.825389,
       2356248.169457, 2373078.513524, 2389908.857592, 2406739.201659,
       2423569.545727, 2440399.889795, 2457230.233862, 2474060.57793 ,
       2490890.921997, 2507721.266065, 2524551.610132, 2541381.9542  ,
       2558212.298267, 2575042.642335, 2591872.986403, 2608703.33047 ,
       2625533.674538, 2642364.018605, 2659194.362673, 2676024.70674 ,
       2692855.050808, 2709685.394875, 2726515.738943, 2743346.08301 ,
       2760176.427078, 2777006.771146, 2793837.115213, 2810667.459281,
       2827497.803348, 2844328.147416, 2861158.491483, 2877988.835551,
       2894819.179618, 2911649.523686, 2928479.867753, 2945310.211821,
       2962140.555889, 2978970.899956, 2995801.244024, 3012631.588091,
       3029461.932159, 3046292.276226, 3063122.620294, 3079952.964361,
       3096783.308429, 3113613.652497, 3130443.996564, 3147274.340632,
       3164104.684699, 3180935.028767, 3197765.372834, 3214595.716902,
       3231426.060969, 3248256.405037, 3265086.749104, 3281917.093172,
       3298747.43724 , 3315577.781307, 3332408.125375, 3349238.469442,
       3366068.81351 , 3382899.157577, 3399729.501645, 3416559.845712,
       3433390.18978 , 3450220.533847, 3467050.877915, 3483881.221983,
       3500711.56605 , 3517541.910118, 3534372.254185, 3551202.598253,
       3568032.94232 , 3584863.286388, 3601693.630455, 3618523.974523,
       3635354.318591, 3652184.662658, 3669015.006726, 3685845.350793,
       3702675.694861, 3719506.038928, 3736336.382996])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>northing</span></div><div class='xr-var-dims'>(northing)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.393e+06 ... -1.836e+06</div><input id='attrs-4e1eae13-1cdd-4be2-b084-50bcab51368f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e1eae13-1cdd-4be2-b084-50bcab51368f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3ee3e90-e8e2-4f51-9032-7f9bbc75c7cd' class='xr-var-data-in' type='checkbox'><label for='data-a3ee3e90-e8e2-4f51-9032-7f9bbc75c7cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-3393301.457246, -3374766.496142, -3356231.535039, -3337696.573935,
       -3319161.612831, -3300626.651727, -3282091.690624, -3263556.72952 ,
       -3245021.768416, -3226486.807313, -3207951.846209, -3189416.885105,
       -3170881.924002, -3152346.962898, -3133812.001794, -3115277.04069 ,
       -3096742.079587, -3078207.118483, -3059672.157379, -3041137.196276,
       -3022602.235172, -3004067.274068, -2985532.312965, -2966997.351861,
       -2948462.390757, -2929927.429653, -2911392.46855 , -2892857.507446,
       -2874322.546342, -2855787.585239, -2837252.624135, -2818717.663031,
       -2800182.701927, -2781647.740824, -2763112.77972 , -2744577.818616,
       -2726042.857513, -2707507.896409, -2688972.935305, -2670437.974202,
       -2651903.013098, -2633368.051994, -2614833.09089 , -2596298.129787,
       -2577763.168683, -2559228.207579, -2540693.246476, -2522158.285372,
       -2503623.324268, -2485088.363165, -2466553.402061, -2448018.440957,
       -2429483.479853, -2410948.51875 , -2392413.557646, -2373878.596542,
       -2355343.635439, -2336808.674335, -2318273.713231, -2299738.752127,
       -2281203.791024, -2262668.82992 , -2244133.868816, -2225598.907713,
       -2207063.946609, -2188528.985505, -2169994.024402, -2151459.063298,
       -2132924.102194, -2114389.14109 , -2095854.179987, -2077319.218883,
       -2058784.257779, -2040249.296676, -2021714.335572, -2003179.374468,
       -1984644.413365, -1966109.452261, -1947574.491157, -1929039.530053,
       -1910504.56895 , -1891969.607846, -1873434.646742, -1854899.685639,
       -1836364.724535])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>top</span></div><div class='xr-var-dims'>(northing, easting)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.16e+03 1.16e+03 ... 0.0 0.0</div><input id='attrs-0232a843-0ae3-4c90-b440-e2b067975f14' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0232a843-0ae3-4c90-b440-e2b067975f14' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc16261a-8545-4374-8988-324f8c35de7e' class='xr-var-data-in' type='checkbox'><label for='data-bc16261a-8545-4374-8988-324f8c35de7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1160.3      , 1160.3      , 1371.8      , ...,    0.       ,
           0.       ,    0.       ],
       [1274.3      , 1274.3      , 1263.8      , ...,    0.       ,
           0.       ,    0.       ],
       [1257.35     , 1257.35     , 1140.6      , ...,    0.       ,
           0.       ,    0.       ],
       ...,
       [1143.85     , 1143.85     , 1130.5      , ...,    0.       ,
           0.       ,    0.       ],
       [1122.15     , 1122.15     , 1107.9      , ...,    2.5499992,
           0.       ,    0.       ],
       [1122.15     , 1122.15     , 1107.9      , ...,    2.5499992,
           0.       ,    0.       ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottom</span></div><div class='xr-var-dims'>(northing, easting)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 -9.4 -25.6</div><input id='attrs-d8955e02-1f85-478b-879d-e942a49e4dd3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d8955e02-1f85-478b-879d-e942a49e4dd3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-260214f3-c27f-441f-a46f-255e910c4eb8' class='xr-var-data-in' type='checkbox'><label for='data-260214f3-c27f-441f-a46f-255e910c4eb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[    0.        ,     0.        ,     0.        , ...,
        -3498.89990234, -4425.        , -4821.60009766],
       [    0.        ,     0.        ,     0.        , ...,
        -3435.14990234, -4329.29980469, -4715.89990234],
       [    0.        ,     0.        ,     0.        , ...,
        -3495.5       , -4341.70019531, -4683.39990234],
       ...,
       [    0.        ,     0.        ,     0.        , ...,
           -5.        ,   -40.20000076,   -26.        ],
       [    0.        ,     0.        ,     0.        , ...,
            0.        ,    -9.39999962,   -25.60000038],
       [    0.        ,     0.        ,     0.        , ...,
            0.        ,    -9.39999962,   -25.60000038]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d392a3f4-d06e-4da0-8d4c-c8c8ed68ddd6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d392a3f4-d06e-4da0-8d4c-c8c8ed68ddd6' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>density</span></div><div class='xr-var-dims'>(northing, easting)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2670 2670 2670 ... 2670 -1630 -1630</div><input id='attrs-6504eff9-7dfa-430a-8715-9ce9c2834d10' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6504eff9-7dfa-430a-8715-9ce9c2834d10' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed60527d-21d4-41e1-a956-f915a0b0c1ce' class='xr-var-data-in' type='checkbox'><label for='data-ed60527d-21d4-41e1-a956-f915a0b0c1ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 2670,  2670,  2670, ..., -1630, -1630, -1630],
       [ 2670,  2670,  2670, ..., -1630, -1630, -1630],
       [ 2670,  2670,  2670, ..., -1630, -1630, -1630],
       ...,
       [ 2670,  2670,  2670, ..., -2670, -1630, -1630],
       [ 2670,  2670,  2670, ...,  2670, -1630, -1630],
       [ 2670,  2670,  2670, ...,  2670, -1630, -1630]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0a4b9bcc-0727-48da-a0e3-6a8b72df1c48' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0a4b9bcc-0727-48da-a0e3-6a8b72df1c48' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>coords_units :</span></dt><dd>meters</dd><dt><span>properties_units :</span></dt><dd>SI</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>To help us visually what this correction is doing, let’s take a look at the density that we assigned across our topographic model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span><span class="p">(</span><span class="n">topography_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;roma+h&quot;</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">grdimage</span><span class="p">(</span><span class="n">topography_model</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;X15c&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;Density of the prism model [kg/m3]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_44_0.png" src="../../_images/gravity-processing_44_0.png" />
</div>
</div>
<p>As prescribed by the model, the density is 2670 kg/m³ in the continents and 1040 - 2670 kg/m³ in the oceans. The exceptions are parts of the continents that are below 0 geometric height, which have a density of -2670 kg/m³.</p>
<p>Now we can forward model the gravitational effect of the topographic/bathymetric masses at the data points and remove it from our gravity disturbance to calculate a <strong>topography-free (Bouguer) disturbance</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">easting_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">northing_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">height_geometric_m</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">terrain_effect_mgal</span><span class="o">=</span><span class="n">topography_model</span><span class="o">.</span><span class="n">prism_layer</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;g_z&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">gravity_bouguer_mgal</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_disturbance_mgal</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">terrain_effect_mgal</span>
<span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
      <th>easting_m</th>
      <th>northing_m</th>
      <th>geoid_m</th>
      <th>height_geometric_m</th>
      <th>normal_gravity_mgal</th>
      <th>gravity_disturbance_mgal</th>
      <th>terrain_effect_mgal</th>
      <th>gravity_bouguer_mgal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8648</th>
      <td>25.01500</td>
      <td>-26.26334</td>
      <td>1230.2</td>
      <td>978681.38</td>
      <td>2.526066e+06</td>
      <td>-2.733052e+06</td>
      <td>27.302536</td>
      <td>1257.502536</td>
      <td>978656.289769</td>
      <td>25.090231</td>
      <td>139.812249</td>
      <td>-114.722018</td>
    </tr>
    <tr>
      <th>8649</th>
      <td>25.01932</td>
      <td>-26.38713</td>
      <td>1297.0</td>
      <td>978669.02</td>
      <td>2.526503e+06</td>
      <td>-2.746924e+06</td>
      <td>27.659737</td>
      <td>1324.659737</td>
      <td>978644.455439</td>
      <td>24.564561</td>
      <td>145.905545</td>
      <td>-121.340984</td>
    </tr>
    <tr>
      <th>8650</th>
      <td>25.02499</td>
      <td>-26.39667</td>
      <td>1304.8</td>
      <td>978669.28</td>
      <td>2.527075e+06</td>
      <td>-2.747994e+06</td>
      <td>27.689820</td>
      <td>1332.489820</td>
      <td>978642.725739</td>
      <td>26.554261</td>
      <td>145.905317</td>
      <td>-119.351056</td>
    </tr>
    <tr>
      <th>8651</th>
      <td>25.04500</td>
      <td>-26.07668</td>
      <td>1165.2</td>
      <td>978681.08</td>
      <td>2.529096e+06</td>
      <td>-2.712163e+06</td>
      <td>26.915163</td>
      <td>1192.115163</td>
      <td>978663.122713</td>
      <td>17.957287</td>
      <td>129.444479</td>
      <td>-111.487193</td>
    </tr>
    <tr>
      <th>8652</th>
      <td>25.07668</td>
      <td>-26.35001</td>
      <td>1262.5</td>
      <td>978665.19</td>
      <td>2.532295e+06</td>
      <td>-2.742763e+06</td>
      <td>27.540560</td>
      <td>1290.040560</td>
      <td>978652.468478</td>
      <td>12.721522</td>
      <td>142.540230</td>
      <td>-129.818707</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12974</th>
      <td>31.51500</td>
      <td>-23.86333</td>
      <td>300.5</td>
      <td>978776.85</td>
      <td>3.182450e+06</td>
      <td>-2.466945e+06</td>
      <td>12.527840</td>
      <td>313.027840</td>
      <td>978781.535934</td>
      <td>-4.685934</td>
      <td>34.376896</td>
      <td>-39.062830</td>
    </tr>
    <tr>
      <th>12975</th>
      <td>31.52499</td>
      <td>-23.30000</td>
      <td>280.7</td>
      <td>978798.55</td>
      <td>3.183459e+06</td>
      <td>-2.405224e+06</td>
      <td>11.987479</td>
      <td>292.687479</td>
      <td>978750.536972</td>
      <td>48.013028</td>
      <td>29.023204</td>
      <td>18.989825</td>
    </tr>
    <tr>
      <th>12976</th>
      <td>31.54832</td>
      <td>-23.19333</td>
      <td>245.7</td>
      <td>978803.55</td>
      <td>3.185814e+06</td>
      <td>-2.393567e+06</td>
      <td>11.897978</td>
      <td>257.597978</td>
      <td>978754.386590</td>
      <td>49.163410</td>
      <td>20.736237</td>
      <td>28.427173</td>
    </tr>
    <tr>
      <th>12977</th>
      <td>31.57333</td>
      <td>-23.84833</td>
      <td>226.8</td>
      <td>978808.44</td>
      <td>3.188340e+06</td>
      <td>-2.465298e+06</td>
      <td>12.483330</td>
      <td>239.283330</td>
      <td>978803.297086</td>
      <td>5.142914</td>
      <td>18.758079</td>
      <td>-13.615165</td>
    </tr>
    <tr>
      <th>13557</th>
      <td>31.37500</td>
      <td>-23.00000</td>
      <td>285.6</td>
      <td>978734.77</td>
      <td>3.168312e+06</td>
      <td>-2.372463e+06</td>
      <td>11.533216</td>
      <td>297.133216</td>
      <td>978729.593092</td>
      <td>5.176908</td>
      <td>26.981424</td>
      <td>-21.804516</td>
    </tr>
  </tbody>
</table>
<p>3877 rows × 12 columns</p>
</div></div></div>
</div>
<p>Plot the Bouguer disturbance on a map so we can see what we have.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">maxabs</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_bouguer_mgal</span><span class="p">)</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">maxabs</span><span class="p">,</span> <span class="n">maxabs</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_bouguer_mgal</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c4p&quot;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;M15c&quot;</span><span class="p">,</span> 
    <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;Bouguer disturbance [mGal]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_49_0.png" src="../../_images/gravity-processing_49_0.png" />
</div>
</div>
<p>As expected, the values are mostly negative and are dominated by the Moho signal.</p>
</div>
<div class="section" id="regional-residual-separation">
<h2>Regional-residual separation<a class="headerlink" href="#regional-residual-separation" title="Permalink to this headline">¶</a></h2>
<p>Bouguer gravity is dominated by the effect of variations in Moho depth because it involves large density contrasts and thicknesses. If we want to see the signal from the shallower intrusions of the Bushveld (often called the <strong>residual</strong>), we’ll need to remove the effect of the deeper and larger sources (often called the <strong>regional</strong>).</p>
<p>Traditionally, this is done by fitting a low-degree 2D polynomial to the data and using it as the regional field. We could do this with <code class="docutils literal notranslate"><span class="pre">verde.Trend</span></code> but we’ll use a different (and better) approach. The reason for not using a polynomial is that it doesn’t take into account the variable height of the observations or the physical nature of the data (a potential field).</p>
<p>A possible alternative would be to model and remove the Moho effect via an Airy isostasy model, which assumes that all topography is locally compensated by the Moho depth variation. This could be done with <code class="docutils literal notranslate"><span class="pre">harmonica.isostasy_airy</span></code> to calculate the Moho depth, followed by <code class="docutils literal notranslate"><span class="pre">harmonica.prism_layer</span></code> to calculate and remove its gravitational effect.</p>
<p>Here, we will use a simpler approach with the <strong>equivalent sources</strong> present in Harmonica to fit a set of deep point sources to the data.</p>
<figure>
<img src="images/equivalent-sources.svg" alt="Sketch equivalent sources method to perform interpolation or predict residuals.">
<figcaption><em>
    Sketch equivalent sources method to perform interpolation or predict residuals.
    (CC-BY).
</em></figcaption>
</figure>
<p>Setting a large depth for the sources means that their field will be long-wavelength and is a good way to represent our regional. The choice of depth is somewhat subjective (as is the choice of polynomial degree) and will depend on the interpretation of the results.</p>
<blockquote>
<div><p><strong>Note</strong>: The equivalent sources approach may have trouble scaling to large datasets. New features in Harmonica are in development to account for this and should be released with the next version of the package. For the moment, it is recommended to pass the data through a <code class="docutils literal notranslate"><span class="pre">verde.BlockMean</span></code> prior to fitting the deep sources to avoid running out of memory.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a set of deep sources at a depth of 500 km</span>
<span class="n">deep_sources</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">EquivalentSources</span><span class="p">(</span><span class="n">damping</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mf">500e3</span><span class="p">)</span>
<span class="c1"># Fit the sources to the data</span>
<span class="n">deep_sources</span><span class="o">.</span><span class="n">fit</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">easting_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">northing_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">height_geometric_m</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">gravity_bouguer_mgal</span><span class="p">)</span>

<span class="c1"># Use the sources to predict the regional field</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">gravity_regional_mgal</span><span class="o">=</span><span class="n">deep_sources</span><span class="o">.</span><span class="n">predict</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">easting_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">northing_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">height_geometric_m</span><span class="p">))</span>
<span class="p">)</span>
<span class="c1"># Calculate a residual field (which is what we want)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">gravity_residual_mgal</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_bouguer_mgal</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">gravity_regional_mgal</span>
<span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height_sea_level_m</th>
      <th>gravity_mgal</th>
      <th>easting_m</th>
      <th>northing_m</th>
      <th>geoid_m</th>
      <th>height_geometric_m</th>
      <th>normal_gravity_mgal</th>
      <th>gravity_disturbance_mgal</th>
      <th>terrain_effect_mgal</th>
      <th>gravity_bouguer_mgal</th>
      <th>gravity_regional_mgal</th>
      <th>gravity_residual_mgal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8648</th>
      <td>25.01500</td>
      <td>-26.26334</td>
      <td>1230.2</td>
      <td>978681.38</td>
      <td>2.526066e+06</td>
      <td>-2.733052e+06</td>
      <td>27.302536</td>
      <td>1257.502536</td>
      <td>978656.289769</td>
      <td>25.090231</td>
      <td>139.812249</td>
      <td>-114.722018</td>
      <td>-116.712155</td>
      <td>1.990137</td>
    </tr>
    <tr>
      <th>8649</th>
      <td>25.01932</td>
      <td>-26.38713</td>
      <td>1297.0</td>
      <td>978669.02</td>
      <td>2.526503e+06</td>
      <td>-2.746924e+06</td>
      <td>27.659737</td>
      <td>1324.659737</td>
      <td>978644.455439</td>
      <td>24.564561</td>
      <td>145.905545</td>
      <td>-121.340984</td>
      <td>-116.655864</td>
      <td>-4.685120</td>
    </tr>
    <tr>
      <th>8650</th>
      <td>25.02499</td>
      <td>-26.39667</td>
      <td>1304.8</td>
      <td>978669.28</td>
      <td>2.527075e+06</td>
      <td>-2.747994e+06</td>
      <td>27.689820</td>
      <td>1332.489820</td>
      <td>978642.725739</td>
      <td>26.554261</td>
      <td>145.905317</td>
      <td>-119.351056</td>
      <td>-116.674517</td>
      <td>-2.676540</td>
    </tr>
    <tr>
      <th>8651</th>
      <td>25.04500</td>
      <td>-26.07668</td>
      <td>1165.2</td>
      <td>978681.08</td>
      <td>2.529096e+06</td>
      <td>-2.712163e+06</td>
      <td>26.915163</td>
      <td>1192.115163</td>
      <td>978663.122713</td>
      <td>17.957287</td>
      <td>129.444479</td>
      <td>-111.487193</td>
      <td>-116.909344</td>
      <td>5.422152</td>
    </tr>
    <tr>
      <th>8652</th>
      <td>25.07668</td>
      <td>-26.35001</td>
      <td>1262.5</td>
      <td>978665.19</td>
      <td>2.532295e+06</td>
      <td>-2.742763e+06</td>
      <td>27.540560</td>
      <td>1290.040560</td>
      <td>978652.468478</td>
      <td>12.721522</td>
      <td>142.540230</td>
      <td>-129.818707</td>
      <td>-116.931033</td>
      <td>-12.887675</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>12974</th>
      <td>31.51500</td>
      <td>-23.86333</td>
      <td>300.5</td>
      <td>978776.85</td>
      <td>3.182450e+06</td>
      <td>-2.466945e+06</td>
      <td>12.527840</td>
      <td>313.027840</td>
      <td>978781.535934</td>
      <td>-4.685934</td>
      <td>34.376896</td>
      <td>-39.062830</td>
      <td>-56.223067</td>
      <td>17.160237</td>
    </tr>
    <tr>
      <th>12975</th>
      <td>31.52499</td>
      <td>-23.30000</td>
      <td>280.7</td>
      <td>978798.55</td>
      <td>3.183459e+06</td>
      <td>-2.405224e+06</td>
      <td>11.987479</td>
      <td>292.687479</td>
      <td>978750.536972</td>
      <td>48.013028</td>
      <td>29.023204</td>
      <td>18.989825</td>
      <td>-49.678543</td>
      <td>68.668368</td>
    </tr>
    <tr>
      <th>12976</th>
      <td>31.54832</td>
      <td>-23.19333</td>
      <td>245.7</td>
      <td>978803.55</td>
      <td>3.185814e+06</td>
      <td>-2.393567e+06</td>
      <td>11.897978</td>
      <td>257.597978</td>
      <td>978754.386590</td>
      <td>49.163410</td>
      <td>20.736237</td>
      <td>28.427173</td>
      <td>-48.047643</td>
      <td>76.474815</td>
    </tr>
    <tr>
      <th>12977</th>
      <td>31.57333</td>
      <td>-23.84833</td>
      <td>226.8</td>
      <td>978808.44</td>
      <td>3.188340e+06</td>
      <td>-2.465298e+06</td>
      <td>12.483330</td>
      <td>239.283330</td>
      <td>978803.297086</td>
      <td>5.142914</td>
      <td>18.758079</td>
      <td>-13.615165</td>
      <td>-54.873920</td>
      <td>41.258755</td>
    </tr>
    <tr>
      <th>13557</th>
      <td>31.37500</td>
      <td>-23.00000</td>
      <td>285.6</td>
      <td>978734.77</td>
      <td>3.168312e+06</td>
      <td>-2.372463e+06</td>
      <td>11.533216</td>
      <td>297.133216</td>
      <td>978729.593092</td>
      <td>5.176908</td>
      <td>26.981424</td>
      <td>-21.804516</td>
      <td>-48.199166</td>
      <td>26.394650</td>
    </tr>
  </tbody>
</table>
<p>3877 rows × 14 columns</p>
</div></div></div>
</div>
<p>Plot a map of the residual field. This should resemble what we know about the geology of the Bushveld.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_residual_mgal</span><span class="p">)</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">gravity_residual_mgal</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c5p&quot;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;M15c&quot;</span><span class="p">,</span> 
    <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;residual field [mGal]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_54_0.png" src="../../_images/gravity-processing_54_0.png" />
</div>
</div>
</div>
<div class="section" id="grid-the-residuals">
<h2>Grid the residuals<a class="headerlink" href="#grid-the-residuals" title="Permalink to this headline">¶</a></h2>
<p>Finally, we can create a regular grid of the residuals at a uniform height. This is a good way to aid visualization and would also allow us to do calculations involving Fourier transforms and other techniques that required gridded data.</p>
<p>The best way to achieve this is, again, the <strong>equivalent sources</strong> in Harmonica. This method allows us to predict the data values on a grid at whatever height we wish (effectively upward-continuing the data), all in a single step. Since our goal here is to accurately model and predict the residual field, we’ll use a shallower depth so that the sources can reproduce the short wavelengths in our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eqs</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">EquivalentSources</span><span class="p">(</span><span class="n">damping</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mf">10e3</span><span class="p">)</span>
<span class="n">eqs</span><span class="o">.</span><span class="n">fit</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">easting_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">northing_m</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">height_geometric_m</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">gravity_residual_mgal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EquivalentSources(damping=10, depth=10000.0)
</pre></div>
</div>
</div>
</div>
<p>Now use the equivalent source model to predict data values on a regular grid at a uniform height. In this case, we will use a height that is slightly larger than the highest observation point to avoid downward continuation. As a bonus, we can pass the projection functions that we used earlier to generate a grid in <strong>geographic coordinates</strong> (longitude, latitude) instead of Cartesian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residual_grid</span> <span class="o">=</span> <span class="n">eqs</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
    <span class="n">upward</span><span class="o">=</span><span class="mi">2200</span><span class="p">,</span>  <span class="c1"># Height in meters</span>
    <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">,</span>
    <span class="n">spacing</span><span class="o">=</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">60</span><span class="p">,</span>  <span class="c1"># Decimal degrees</span>
    <span class="n">data_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;gravity_residual&quot;</span><span class="p">],</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">),</span>
    <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">residual_grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/m/anaconda3/envs/fatiando-tutorials/lib/python3.9/site-packages/verde/base/base_classes.py:463: FutureWarning: The &#39;spacing&#39;, &#39;shape&#39; and &#39;region&#39; arguments will be removed in Verde v2.0.0. Please use the &#39;verde.grid_coordinates&#39; function to define grid coordinates and pass them as the &#39;coordinates&#39; argument.
  warnings.warn(
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:           (latitude: 121, longitude: 211)
Coordinates:
  * longitude         (longitude) float64 25.0 25.03 25.07 ... 31.93 31.97 32.0
  * latitude          (latitude) float64 -27.0 -26.97 -26.93 ... -23.03 -23.0
    upward            (latitude, longitude) float64 2.2e+03 2.2e+03 ... 2.2e+03
Data variables:
    gravity_residual  (latitude, longitude) float64 0.7897 0.8992 ... 19.54
Attributes:
    metadata:  Generated by EquivalentSources(damping=10, depth=10000.0)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6d1cb15a-428e-4b26-948f-6bcaa147850e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6d1cb15a-428e-4b26-948f-6bcaa147850e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 121</li><li><span class='xr-has-index'>longitude</span>: 211</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b32474ab-abd1-4cc8-b2bb-b3f1375c12ad' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b32474ab-abd1-4cc8-b2bb-b3f1375c12ad' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>25.0 25.03 25.07 ... 31.97 32.0</div><input id='attrs-cf1517e7-1e2e-4934-b9c0-de8314f15e32' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf1517e7-1e2e-4934-b9c0-de8314f15e32' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7679a3a5-e3ce-4f34-ad94-85a47848d523' class='xr-var-data-in' type='checkbox'><label for='data-7679a3a5-e3ce-4f34-ad94-85a47848d523' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([25.      , 25.033333, 25.066667, ..., 31.933333, 31.966667, 32.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-27.0 -26.97 ... -23.03 -23.0</div><input id='attrs-3a9b69f4-762c-489b-bd03-1b813c2f9464' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3a9b69f4-762c-489b-bd03-1b813c2f9464' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-69c25d1c-ef94-4f59-9861-a34de89f544d' class='xr-var-data-in' type='checkbox'><label for='data-69c25d1c-ef94-4f59-9861-a34de89f544d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-27.      , -26.966667, -26.933333, -26.9     , -26.866667, -26.833333,
       -26.8     , -26.766667, -26.733333, -26.7     , -26.666667, -26.633333,
       -26.6     , -26.566667, -26.533333, -26.5     , -26.466667, -26.433333,
       -26.4     , -26.366667, -26.333333, -26.3     , -26.266667, -26.233333,
       -26.2     , -26.166667, -26.133333, -26.1     , -26.066667, -26.033333,
       -26.      , -25.966667, -25.933333, -25.9     , -25.866667, -25.833333,
       -25.8     , -25.766667, -25.733333, -25.7     , -25.666667, -25.633333,
       -25.6     , -25.566667, -25.533333, -25.5     , -25.466667, -25.433333,
       -25.4     , -25.366667, -25.333333, -25.3     , -25.266667, -25.233333,
       -25.2     , -25.166667, -25.133333, -25.1     , -25.066667, -25.033333,
       -25.      , -24.966667, -24.933333, -24.9     , -24.866667, -24.833333,
       -24.8     , -24.766667, -24.733333, -24.7     , -24.666667, -24.633333,
       -24.6     , -24.566667, -24.533333, -24.5     , -24.466667, -24.433333,
       -24.4     , -24.366667, -24.333333, -24.3     , -24.266667, -24.233333,
       -24.2     , -24.166667, -24.133333, -24.1     , -24.066667, -24.033333,
       -24.      , -23.966667, -23.933333, -23.9     , -23.866667, -23.833333,
       -23.8     , -23.766667, -23.733333, -23.7     , -23.666667, -23.633333,
       -23.6     , -23.566667, -23.533333, -23.5     , -23.466667, -23.433333,
       -23.4     , -23.366667, -23.333333, -23.3     , -23.266667, -23.233333,
       -23.2     , -23.166667, -23.133333, -23.1     , -23.066667, -23.033333,
       -23.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>upward</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.2e+03 2.2e+03 ... 2.2e+03 2.2e+03</div><input id='attrs-c23d4669-dc72-4e64-bbd6-196eb43e276b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c23d4669-dc72-4e64-bbd6-196eb43e276b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e20474b-7b6f-40a2-be19-8bec3e62d0b6' class='xr-var-data-in' type='checkbox'><label for='data-4e20474b-7b6f-40a2-be19-8bec3e62d0b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[2200., 2200., 2200., ..., 2200., 2200., 2200.],
       [2200., 2200., 2200., ..., 2200., 2200., 2200.],
       [2200., 2200., 2200., ..., 2200., 2200., 2200.],
       ...,
       [2200., 2200., 2200., ..., 2200., 2200., 2200.],
       [2200., 2200., 2200., ..., 2200., 2200., 2200.],
       [2200., 2200., 2200., ..., 2200., 2200., 2200.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-53ee95ca-9a2a-4eda-bb58-d9841e3fa8f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-53ee95ca-9a2a-4eda-bb58-d9841e3fa8f1' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>gravity_residual</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.7897 0.8992 1.041 ... 20.31 19.54</div><input id='attrs-bfde5cd4-f5de-4454-a8ff-c7ab6c19f2a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bfde5cd4-f5de-4454-a8ff-c7ab6c19f2a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9372cf46-654e-4e58-b830-3d681bd6e045' class='xr-var-data-in' type='checkbox'><label for='data-9372cf46-654e-4e58-b830-3d681bd6e045' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>metadata :</span></dt><dd>Generated by EquivalentSources(damping=10, depth=10000.0)</dd></dl></div><div class='xr-var-data'><pre>array([[ 0.7897479 ,  0.89921342,  1.0409133 , ..., 73.8953911 ,
        76.54286897, 75.68319032],
       [ 0.73600377,  0.85193772,  1.00586011, ..., 85.29662089,
        88.24467827, 86.36140444],
       [ 0.65168445,  0.76833111,  0.9279719 , ..., 94.48763052,
        97.79052661, 95.27176799],
       ...,
       [-0.12373018, -0.16144338, -0.20034207, ..., 22.82159255,
        21.77473978, 20.84033382],
       [-0.11204588, -0.14847809, -0.18602001, ..., 21.99478882,
        21.05223363, 20.20102864],
       [-0.09976836, -0.1349454 , -0.17116038, ..., 21.14472326,
        20.30656567, 19.54009947]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9c9106c7-3d6b-4a16-aed3-d1ce6ac366c0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9c9106c7-3d6b-4a16-aed3-d1ce6ac366c0' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>metadata :</span></dt><dd>Generated by EquivalentSources(damping=10, depth=10000.0)</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Plot the gridded residuals on a map and overlay the observation points. It’s always important to know where the actual data points are so we can avoid interpreting features in the grid that are likely just an artifact of the data sampling. This is particularly important in areas with sparse and uneven data coverage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">pygmt</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">scale</span> <span class="o">=</span> <span class="n">vd</span><span class="o">.</span><span class="n">maxabs</span><span class="p">(</span><span class="n">residual_grid</span><span class="o">.</span><span class="n">gravity_residual</span><span class="p">)</span>
<span class="n">pygmt</span><span class="o">.</span><span class="n">makecpt</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span> <span class="n">scale</span><span class="p">],</span> <span class="n">no_bg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">grdimage</span><span class="p">(</span>
    <span class="n">residual_grid</span><span class="o">.</span><span class="n">gravity_residual</span><span class="p">,</span>
    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;+a45+nt0.15&quot;</span><span class="p">,</span>
    <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;M15c&quot;</span><span class="p">,</span>
    <span class="n">frame</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="s1">&#39;af+l&quot;residual field [mGal]&quot;&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;c0.02c&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/gravity-processing_60_0.png" src="../../_images/gravity-processing_60_0.png" />
</div>
</div>
</div>
<div class="section" id="where-to-go-next">
<h2>Where to go next<a class="headerlink" href="#where-to-go-next" title="Permalink to this headline">¶</a></h2>
<p><strong>Congratulations!</strong> You’ve now completed our gravity processing tutorial. Here are few things you can do now:</p>
<ul class="simple">
<li><p>Try using your own data.</p></li>
<li><p>Change the values of certain parameters (topographic density, equivalent source depth, etc) and see what happens.</p></li>
<li><p>Learn more about the individual packages by reading their documentation: <a class="reference external" href="https://www.fatiando.org/learn">https://www.fatiando.org/learn</a></p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>All Python source code is made available under the BSD 3-clause license. You
can freely use and modify the code, without warranty, so long as you provide
attribution to the authors.</p>
<p>Unless otherwise specified, all figures and Jupyter notebooks are available
under the Creative Commons Attribution 4.0 License (CC-BY).</p>
<p>The full text of these licenses is provided in the <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">LICENSE.txt</span></code></span>
file.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/transform"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../verde/blockreduce_weights.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Using weights in blocked reduction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../verde/scipygridder.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Gridding with Scipy</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Fatiando a Terra<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>